<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AICENGHUB</title>
  <link rel="icon" type="image/jpeg" href="./favicoaiceng.jpg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="image" href="./crazybunny.jpg">
  <link rel="preload" as="audio" href="./bunnygrowl.mp4">
  <link rel="preload" as="audio" href="./ost1.mp3">
  <link rel="preload" as="audio" href="./ost2.mp3">
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Barlow:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-1: #120e24;
      --bg-2: #1e1b3f;
      --ink: #f8f7f5;
      --muted: #cec7b7;
      --gold: #f4b73f;
      --panel: rgba(18, 14, 36, 0.82);
      --border: rgba(244, 183, 63, 0.45);
      --shadow: 0 16px 38px rgba(0, 0, 0, 0.38);
    }

    * {
      box-sizing: border-box;
    }

    button {
      transition: filter 130ms ease, transform 130ms ease, box-shadow 130ms ease;
    }

    button:not(:disabled):hover {
      filter: brightness(1.06);
      transform: translateY(-1px);
    }

    button:not(:disabled):active {
      filter: brightness(0.98);
      transform: translateY(0) scale(0.98);
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Barlow", "Segoe UI", Tahoma, sans-serif;
      color: var(--ink);
      background:
        linear-gradient(180deg, rgba(202, 58, 40, 0.22), transparent 24%),
        radial-gradient(130% 80% at 50% 0%, #3d2a65 0%, var(--bg-2) 42%, var(--bg-1) 100%);
      line-height: 1.45;
    }

    body.consent-open {
      overflow: hidden;
    }

    body.tool-detail-open {
      overflow: hidden;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        repeating-linear-gradient(
          0deg,
          rgba(255, 255, 255, 0.03) 0,
          rgba(255, 255, 255, 0.03) 1px,
          transparent 2px,
          transparent 5px
        );
      mix-blend-mode: soft-light;
      opacity: 0.55;
      z-index: 0;
    }

    .container {
      position: relative;
      z-index: 1;
      width: min(1200px, 92vw);
      margin: 2.2rem auto 3rem;
    }

    .app-version {
      margin: 0 0 0.5rem 0.15rem;
      font-size: 0.68rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(248, 247, 245, 0.42);
      user-select: none;
      pointer-events: auto;
      cursor: pointer;
      width: fit-content;
      border-radius: 6px;
      padding: 0.08rem 0.22rem;
      transition: color 130ms ease, background-color 130ms ease;
    }

    .app-version:hover {
      color: rgba(248, 247, 245, 0.62);
      background: rgba(255, 255, 255, 0.05);
    }

    .hero {
      display: grid;
      grid-template-columns: 1.08fr 0.92fr;
      gap: 1.5rem;
      padding: 1.6rem;
      border: 1px solid var(--border);
      border-radius: 20px;
      background:
        linear-gradient(145deg, rgba(30, 184, 199, 0.12), rgba(202, 58, 40, 0.12)),
        var(--panel);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .hero h1 {
      margin: 0;
      font-family: "Bebas Neue", Impact, sans-serif;
      letter-spacing: 0.06em;
      font-size: clamp(2.2rem, 6vw, 4rem);
      color: var(--gold);
      text-transform: uppercase;
      text-shadow: 0 6px 14px rgba(0, 0, 0, 0.35);
    }

    .hero p {
      margin-top: 0.7rem;
      max-width: 62ch;
      color: var(--muted);
      font-size: clamp(1rem, 2.2vw, 1.08rem);
    }

    .lang-switch {
      display: inline-flex;
      gap: 0.4rem;
      margin-top: 0.2rem;
    }

    .hero-controls {
      margin-top: 0.85rem;
      display: flex;
      align-items: center;
      gap: 0.55rem;
      flex-wrap: wrap;
    }

    .lang-btn {
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.07);
      color: var(--ink);
      border-radius: 999px;
      padding: 0.32rem 0.62rem;
      font: inherit;
      font-size: 0.78rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      cursor: pointer;
      text-transform: uppercase;
    }

    .lang-btn:hover {
      filter: brightness(1.08);
      transform: translateY(-1px);
    }

    .lang-btn[aria-pressed="true"] {
      color: #1a1310;
      border-color: rgba(244, 183, 63, 0.94);
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      box-shadow: 0 0 0 2px rgba(247, 202, 111, 0.16);
    }

    .search-bar {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .search-input {
      flex: 1 1 260px;
      min-width: 180px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(12, 10, 24, 0.8);
      color: var(--ink);
      padding: 0.62rem 0.72rem;
      font: inherit;
    }

    .search-input::placeholder {
      color: rgba(248, 247, 245, 0.7);
    }

    .search-btn {
      border: 1px solid rgba(244, 183, 63, 0.8);
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
      border-radius: 10px;
      padding: 0.62rem 0.9rem;
      font: inherit;
      font-weight: 700;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 0.02em;
    }

    .hero-image-wrap {
      align-self: stretch;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid rgba(244, 183, 63, 0.38);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.08);
      background: #0f0d19;
    }

    .hero-image-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      filter: saturate(1.08) contrast(1.06);
    }

    .tabs-shell {
      margin-top: 1.2rem;
      border-radius: 20px;
      border: 1px solid var(--border);
      background: var(--panel);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .tabs-top {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      padding: 0.9rem;
      border-bottom: 1px solid rgba(244, 183, 63, 0.28);
      background: rgba(0, 0, 0, 0.14);
    }

    .tablist {
      display: flex;
      flex-wrap: wrap;
      gap: 0.42rem;
      flex: 1 1 auto;
      min-width: 0;
    }

    .tab-search {
      margin-left: auto;
      flex: 0 1 380px;
      min-width: 260px;
      max-width: 42%;
    }

    .tab-search .search-btn {
      flex: 0 0 auto;
    }

    .tab-btn {
      border: 1px solid rgba(255, 255, 255, 0.28);
      background: rgba(255, 255, 255, 0.04);
      color: #f2edf2;
      border-radius: 999px;
      padding: 0.5rem 0.85rem;
      font-weight: 600;
      font-size: 0.82rem;
      letter-spacing: 0.03em;
      cursor: pointer;
      text-transform: uppercase;
      transition: all 160ms ease;
    }

    .tab-btn:hover {
      filter: brightness(1.08);
    }

    .tab-btn[aria-selected="true"] {
      outline: 2px solid rgba(255, 242, 201, 0.95);
      outline-offset: 1px;
      box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.22) inset;
    }

    .tab-btn[data-filter-key="all"] {
      background: rgba(244, 183, 63, 0.2);
      border-color: rgba(244, 183, 63, 0.72);
      color: #ffefbf;
    }

    .tab-btn[data-filter-key="all"][aria-selected="true"] {
      background: #f0b84e;
      border-color: #f0b84e;
      color: #1d1300;
    }

    .tab-btn[data-filter-key="text"] {
      background: rgba(47, 158, 68, 0.2);
      border-color: rgba(47, 158, 68, 0.72);
      color: #d9ffe0;
    }

    .tab-btn[data-filter-key="text"][aria-selected="true"] {
      background: #2f9e44;
      border-color: #2f9e44;
      color: #f0ffef;
    }

    .tab-btn[data-filter-key="image"] {
      background: rgba(242, 201, 76, 0.22);
      border-color: rgba(242, 201, 76, 0.76);
      color: #fff4c6;
    }

    .tab-btn[data-filter-key="image"][aria-selected="true"] {
      background: #f2c94c;
      border-color: #f2c94c;
      color: #2a2100;
    }

    .tab-btn[data-filter-key="video"] {
      background: rgba(242, 153, 74, 0.22);
      border-color: rgba(242, 153, 74, 0.76);
      color: #ffe5c9;
    }

    .tab-btn[data-filter-key="video"][aria-selected="true"] {
      background: #f2994a;
      border-color: #f2994a;
      color: #2b1300;
    }

    .tab-btn[data-filter-key="audio"] {
      background: rgba(59, 130, 246, 0.22);
      border-color: rgba(59, 130, 246, 0.72);
      color: #dbeafe;
    }

    .tab-btn[data-filter-key="audio"][aria-selected="true"] {
      background: #3b82f6;
      border-color: #3b82f6;
      color: #f4f8ff;
    }

    .tab-btn[data-filter-key="code"] {
      background: rgba(139, 92, 246, 0.22);
      border-color: rgba(139, 92, 246, 0.72);
      color: #eee5ff;
    }

    .tab-btn[data-filter-key="code"][aria-selected="true"] {
      background: #8b5cf6;
      border-color: #8b5cf6;
      color: #f6efff;
    }

    .tab-btn[data-filter-key="automation"] {
      background: rgba(139, 94, 52, 0.24);
      border-color: rgba(139, 94, 52, 0.76);
      color: #ffe6cf;
    }

    .tab-btn[data-filter-key="automation"][aria-selected="true"] {
      background: #8b5e34;
      border-color: #8b5e34;
      color: #fff2e4;
    }

    .tab-btn[data-filter-key="learning"] {
      background: rgba(214, 69, 69, 0.24);
      border-color: rgba(214, 69, 69, 0.78);
      color: #ffe1e1;
    }

    .tab-btn[data-filter-key="learning"][aria-selected="true"] {
      background: #d64545;
      border-color: #d64545;
      color: #fff3f3;
    }

    .panel {
      padding: 1.2rem;
    }

    .panel-head {
      margin-bottom: 1rem;
    }

    .panel-head h2 {
      margin: 0;
      font-size: 1.28rem;
      color: #ffe9af;
      letter-spacing: 0.02em;
    }

    .panel-head p {
      margin: 0.38rem 0 0;
      color: var(--muted);
    }

    .search-status {
      margin: 0.4rem 0 1rem;
      color: #f5deb5;
      font-weight: 600;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(255px, 1fr));
      gap: 0.85rem;
    }

    .card {
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.05), rgba(30, 184, 199, 0.04));
      padding: 0.9rem;
      cursor: pointer;
      transition: transform 140ms ease, border-color 140ms ease, box-shadow 140ms ease;
    }

    .card:hover {
      transform: translateY(-2px);
      border-color: rgba(30, 184, 199, 0.58);
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.26);
    }

    .card:focus-visible {
      outline: 2px solid rgba(30, 184, 199, 0.88);
      outline-offset: 2px;
    }

    .card-head-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 0.6rem;
      margin-bottom: 0.36rem;
      flex-wrap: wrap;
    }

    .card h3 {
      margin: 0;
      font-size: 1rem;
      color: #fff2c9;
      line-height: 1.2;
    }

    .ability-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.32rem;
      justify-content: flex-end;
      max-width: 100%;
    }

    .ability-pill {
      display: inline-block;
      width: 0.62rem;
      height: 0.62rem;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.28);
      padding: 0;
      font-size: 0;
      line-height: 0;
    }

    .ability-text { background: #2f9e44; color: #f0ffef; }
    .ability-image { background: #f2c94c; color: #2a2100; }
    .ability-video { background: #f2994a; color: #2b1300; }
    .ability-audio { background: #3b82f6; color: #f4f8ff; }
    .ability-code { background: #8b5cf6; color: #f6efff; }
    .ability-automation { background: #8b5e34; color: #fff2e4; }
    .ability-learning { background: #d64545; color: #fff3f3; }

    .tool-tag-list {
      margin: 0.1rem 0 0.6rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.34rem;
    }

    .tool-tag {
      border: 1px solid rgba(255, 255, 255, 0.24);
      background: rgba(255, 255, 255, 0.06);
      color: #def8ff;
      border-radius: 999px;
      padding: 0.18rem 0.46rem;
      font-size: 0.72rem;
      line-height: 1.2;
      font-weight: 600;
      letter-spacing: 0.01em;
      white-space: normal;
    }

    .tool-tag-watermarked {
      border-color: rgba(255, 255, 255, 0.38);
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.16), rgba(0, 0, 0, 0.22));
      color: #f7f7f7;
    }

    .pricing-row {
      margin: 0.15rem 0 0.68rem;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 999px;
      padding: 0.24rem 0.5rem 0.24rem 0.38rem;
      background: rgba(255, 255, 255, 0.05);
    }

    .pricing-pill {
      width: 0.72rem;
      height: 0.72rem;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.58);
      display: inline-block;
      flex: 0 0 auto;
    }

    .pricing-pill-free {
      background: #000;
    }

    .pricing-pill-trial {
      background: linear-gradient(90deg, #000 50%, #fff 50%);
    }

    .pricing-pill-paid {
      background: #fff;
    }

    .pricing-text {
      color: #e8f9ff;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 0.02em;
      line-height: 1;
    }

    .card p {
      margin: 0.3rem 0 0.72rem;
      color: var(--muted);
      font-size: 0.94rem;
    }

    .card a {
      color: #8de9ff;
      text-decoration: none;
      font-weight: 600;
    }

    .card a:hover {
      text-decoration: underline;
      color: #cbf6ff;
    }

    .tool-detail-overlay {
      position: fixed;
      inset: 0;
      z-index: 80;
      display: grid;
      place-items: center;
      padding: 1.1rem;
      background: rgba(8, 6, 18, 0.82);
      backdrop-filter: blur(6px);
      opacity: 0;
      transition: opacity 180ms ease;
    }

    .tool-detail-overlay.is-open {
      opacity: 1;
    }

    .tool-detail-overlay[hidden] {
      display: none;
    }

    .tool-detail-card {
      position: relative;
      width: min(940px, 100%);
      max-height: calc(100vh - 2.2rem);
      border: 1px solid rgba(30, 184, 199, 0.42);
      border-radius: 16px;
      background:
        linear-gradient(160deg, rgba(30, 184, 199, 0.14), rgba(244, 183, 63, 0.12)),
        rgba(12, 10, 25, 0.98);
      box-shadow: 0 22px 52px rgba(0, 0, 0, 0.52);
      overflow: auto;
    }

    .tool-detail-close {
      position: absolute;
      top: 0.72rem;
      right: 0.72rem;
      width: 2.1rem;
      height: 2.1rem;
      border: 1px solid rgba(255, 255, 255, 0.32);
      background: rgba(255, 255, 255, 0.08);
      color: #f8f7f5;
      border-radius: 10px;
      font: inherit;
      font-size: 1.05rem;
      font-weight: 700;
      line-height: 1;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .tool-detail-close:hover {
      filter: brightness(1.08);
    }

    .tool-detail-layout {
      display: grid;
      grid-template-columns: minmax(0, 260px) minmax(0, 1fr);
      gap: 1rem;
      padding: 1rem 1rem 1.05rem;
    }

    .tool-detail-visual {
      display: grid;
      gap: 0.7rem;
      align-content: flex-start;
    }

    .tool-detail-logo-wrap {
      position: relative;
      width: 100%;
      min-height: 230px;
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.22);
      overflow: hidden;
      background:
        radial-gradient(130% 110% at 20% 10%, rgba(30, 184, 199, 0.35), transparent 55%),
        radial-gradient(130% 110% at 80% 90%, rgba(244, 183, 63, 0.28), transparent 50%),
        rgba(8, 10, 20, 0.7);
      display: grid;
      place-items: center;
      padding: 0.95rem;
    }

    .tool-detail-logo {
      max-width: 100%;
      max-height: 180px;
      object-fit: contain;
      display: block;
      filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.3));
    }

    .tool-detail-logo-fallback {
      width: 100%;
      min-height: 180px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(255, 255, 255, 0.08);
      display: grid;
      place-items: center;
      color: #ecfbff;
      font-family: "Bebas Neue", Impact, sans-serif;
      font-size: 3rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .tool-detail-logo-fallback[hidden] {
      display: none;
    }

    .tool-detail-favicon-row {
      display: inline-flex;
      align-items: center;
      gap: 0.55rem;
      border: 1px solid rgba(255, 255, 255, 0.23);
      border-radius: 999px;
      padding: 0.28rem 0.56rem;
      width: fit-content;
      max-width: 100%;
      background: rgba(255, 255, 255, 0.06);
    }

    .tool-detail-favicon {
      width: 1.15rem;
      height: 1.15rem;
      border-radius: 50%;
      object-fit: contain;
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.25);
      flex: 0 0 auto;
    }

    .tool-detail-domain {
      min-width: 0;
      color: #def8ff;
      font-size: 0.8rem;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .tool-detail-main {
      min-width: 0;
    }

    .tool-detail-eyebrow {
      margin: 0;
      color: rgba(203, 246, 255, 0.82);
      font-size: 0.76rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 700;
    }

    .tool-detail-title {
      margin: 0.28rem 0 0;
      font-size: clamp(1.35rem, 2.5vw, 2rem);
      line-height: 1.15;
      color: #fff2c9;
    }

    .tool-detail-description {
      margin: 0.72rem 0 0;
      color: #d8f2ff;
      line-height: 1.5;
      font-size: 0.95rem;
      max-width: 68ch;
    }

    .tool-detail-sections {
      margin-top: 0.86rem;
      display: grid;
      gap: 0.72rem;
    }

    .tool-detail-block {
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.04);
      padding: 0.62rem 0.7rem;
    }

    .tool-detail-block strong {
      display: block;
      margin: 0;
      color: #ffe9af;
      font-size: 0.8rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .tool-detail-pill-list {
      margin-top: 0.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.34rem;
    }

    .tool-detail-ability-tag {
      border: 1px solid rgba(255, 255, 255, 0.24);
      border-radius: 999px;
      padding: 0.2rem 0.48rem;
      font-size: 0.74rem;
      line-height: 1.2;
      font-weight: 700;
      background: rgba(255, 255, 255, 0.07);
      color: #def8ff;
      text-transform: uppercase;
      letter-spacing: 0.02em;
    }

    .tool-detail-pricing-row {
      margin: 0.48rem 0 0;
    }

    .tool-detail-actions {
      margin-top: 0.86rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.55rem;
      align-items: center;
    }

    .tool-detail-open-link {
      border: 1px solid rgba(244, 183, 63, 0.8);
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
      border-radius: 9px;
      padding: 0.52rem 0.78rem;
      font-size: 0.84rem;
      font-weight: 700;
      letter-spacing: 0.02em;
      text-transform: uppercase;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-height: 2.25rem;
      transition: filter 130ms ease, transform 130ms ease, box-shadow 130ms ease;
    }

    .tool-detail-open-link:hover {
      filter: brightness(1.06);
      transform: translateY(-1px);
    }

    .tool-detail-open-link:active {
      filter: brightness(0.98);
      transform: translateY(0) scale(0.98);
    }

    .footer-shell {
      margin-top: 1rem;
      text-align: center;
      color: rgba(255, 255, 255, 0.75);
      font-size: 0.9rem;
      display: grid;
      gap: 0.55rem;
      justify-items: center;
    }

    .footer-shell p {
      margin: 0;
    }

    .footer-title {
      color: rgba(255, 255, 255, 0.88);
      font-size: 1rem;
      font-weight: 700;
      line-height: 1.35;
    }

    .footer-subtitle {
      color: rgba(255, 255, 255, 0.78);
      font-size: 0.9rem;
      line-height: 1.35;
    }

    .footer-links {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    .footer-dot {
      color: rgba(255, 255, 255, 0.58);
      font-size: 0.9rem;
      line-height: 1;
    }

    .footer-link-btn,
    .footer-link-anchor {
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.08);
      color: #def8ff;
      border-radius: 999px;
      padding: 0.32rem 0.64rem;
      font: inherit;
      font-size: 0.78rem;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      transition: filter 130ms ease, transform 130ms ease;
    }

    .footer-link-btn:hover,
    .footer-link-anchor:hover {
      filter: brightness(1.08);
      transform: translateY(-1px);
    }

    .footer-link-btn:active,
    .footer-link-anchor:active {
      filter: brightness(0.98);
      transform: translateY(0) scale(0.98);
    }

    .footer-meta {
      color: rgba(255, 255, 255, 0.72);
      font-size: 0.78rem;
      line-height: 1.25;
    }

    .bunny-fab {
      position: fixed;
      right: 1rem;
      bottom: 1rem;
      z-index: 3;
      border: 1px solid rgba(244, 183, 63, 0.88);
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
      border-radius: 999px;
      width: 3.5rem;
      height: 3.5rem;
      padding: 0;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
      cursor: pointer;
    }

    .bunny-fab:hover {
      filter: brightness(1.04);
    }

    .bunny-fab:focus-visible {
      outline: 2px solid #fff2c9;
      outline-offset: 2px;
    }

    .bunny-fab img {
      display: block;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .juleha-fab {
      position: fixed;
      right: 5.8rem;
      bottom: calc(1rem + 3.8rem);
      z-index: 5;
      border: 1px solid rgba(30, 184, 199, 0.85);
      background: linear-gradient(180deg, #39d7e6, #1aa8bd);
      color: #08161a;
      border-radius: 999px;
      min-width: 9.4rem;
      height: 3.8rem;
      padding: 0 1.15rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font: inherit;
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.01em;
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
      cursor: pointer;
      transition: filter 130ms ease, transform 130ms ease;
    }

    .juleha-fab:hover {
      filter: brightness(1.06);
      transform: translateY(-1px);
    }

    .juleha-fab:focus-visible {
      outline: 2px solid #cbf6ff;
      outline-offset: 2px;
    }

    .music-toggle {
      border: 1px solid rgba(244, 183, 63, 0.78);
      background: rgba(10, 8, 19, 0.86);
      color: #ffe9b3;
      border-radius: 999px;
      min-width: 7.8rem;
      height: 2.3rem;
      padding: 0 0.95rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font: inherit;
      font-size: 0.8rem;
      font-weight: 700;
      letter-spacing: 0.02em;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.28);
      cursor: pointer;
      transition: filter 130ms ease, transform 130ms ease;
    }

    .music-toggle:hover {
      filter: brightness(1.08);
      transform: translateY(-1px);
    }

    .music-toggle[aria-pressed="true"] {
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
      border-color: rgba(244, 183, 63, 0.92);
    }

    .music-toggle:focus-visible {
      outline: 2px solid #fff2c9;
      outline-offset: 2px;
    }

    .welcome-popup {
      position: fixed;
      inset: 0;
      z-index: 90;
      display: grid;
      place-items: center;
      padding: 1rem;
      background: rgba(6, 4, 14, 0.75);
      backdrop-filter: blur(4px);
    }

    .welcome-popup[hidden] {
      display: none;
    }

    .welcome-popup-card {
      width: min(560px, 100%);
      border: 1px solid rgba(244, 183, 63, 0.45);
      border-radius: 14px;
      background:
        linear-gradient(145deg, rgba(30, 184, 199, 0.12), rgba(202, 58, 40, 0.1)),
        rgba(14, 12, 28, 0.96);
      box-shadow: 0 20px 44px rgba(0, 0, 0, 0.42);
      padding: 1rem 1rem 0.95rem;
    }

    .welcome-popup-card h3 {
      margin: 0;
      font-size: 1.05rem;
      color: #b9f5ff;
    }

    .welcome-popup-card p {
      margin: 0.62rem 0 0;
      color: #d8f2ff;
      line-height: 1.45;
      font-size: 0.94rem;
    }

    .consent-legal-row {
      margin-top: 0.78rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.7rem;
    }

    .consent-legal-link {
      display: inline-block;
      color: #9be8ff;
      text-decoration: underline;
      text-underline-offset: 2px;
      font-size: 0.88rem;
      font-weight: 600;
      transition: filter 130ms ease, transform 130ms ease, color 130ms ease;
    }

    .consent-legal-link:hover {
      color: #cbf5ff;
    }

    .consent-legal-link:active {
      filter: brightness(0.98);
      transform: translateY(0) scale(0.98);
    }

    .consent-lang-toggle {
      border: 1px solid rgba(244, 183, 63, 0.94);
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
      border-radius: 999px;
      padding: 0.32rem 0.62rem;
      font: inherit;
      font-size: 0.78rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      min-width: 3.2rem;
      text-align: center;
      cursor: pointer;
      text-transform: uppercase;
      box-shadow: 0 0 0 2px rgba(247, 202, 111, 0.16);
    }

    .consent-lang-toggle:hover {
      filter: brightness(1.08);
      transform: translateY(-1px);
    }

    .consent-lang-toggle:focus-visible {
      outline: 2px solid #cbf6ff;
      outline-offset: 2px;
    }

    .consent-actions {
      margin-top: 0.94rem;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.56rem;
    }

    .consent-btn {
      border: 1px solid rgba(244, 183, 63, 0.74);
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
      border-radius: 9px;
      padding: 0.66rem 0.82rem;
      font: inherit;
      font-size: 0.92rem;
      font-weight: 700;
      cursor: pointer;
      min-height: 2.8rem;
      text-align: center;
      transition: filter 130ms ease, transform 130ms ease;
    }

    .consent-btn:hover {
      filter: brightness(1.06);
      transform: translateY(-1px);
    }

    .consent-btn.primary {
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
    }

    .consent-settings {
      margin-top: 0.94rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      background: rgba(7, 12, 26, 0.42);
      padding: 0.84rem;
      animation: consent-panel-reveal 180ms ease;
    }

    .consent-settings[hidden] {
      display: none;
    }

    @keyframes consent-panel-reveal {
      from {
        opacity: 0;
        transform: translateY(6px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .consent-setting-item {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 0.6rem;
      padding: 0.56rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.11);
    }

    .consent-setting-item:last-child {
      border-bottom: none;
    }

    .consent-setting-item strong {
      display: block;
      font-size: 0.92rem;
      color: #d9f6ff;
    }

    .consent-setting-item p {
      margin: 0.2rem 0 0;
      font-size: 0.84rem;
      color: #cbc7b7;
      line-height: 1.35;
    }

    .consent-toggle-wrap {
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .consent-switch {
      appearance: none;
      width: 2.5rem;
      height: 1.45rem;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.18);
      border: 1px solid rgba(255, 255, 255, 0.35);
      position: relative;
      cursor: pointer;
      transition: background-color 130ms ease, border-color 130ms ease, transform 130ms ease, box-shadow 130ms ease;
    }

    .consent-switch::after {
      content: "";
      position: absolute;
      top: 0.14rem;
      left: 0.14rem;
      width: 1rem;
      height: 1rem;
      border-radius: 999px;
      background: #fff;
      transition: transform 130ms ease;
    }

    .consent-switch:checked {
      background: rgba(244, 183, 63, 0.8);
      border-color: rgba(244, 183, 63, 0.95);
    }

    .consent-switch:checked::after {
      transform: translateX(1.02rem);
      background: #1a1310;
    }

    .consent-switch:not(:disabled):hover {
      border-color: rgba(244, 183, 63, 0.92);
      box-shadow: 0 0 0 2px rgba(244, 183, 63, 0.2);
      transform: translateY(-1px);
    }

    .consent-switch:not(:disabled):active {
      transform: translateY(0) scale(0.96);
    }

    .consent-switch:disabled {
      opacity: 0.78;
      cursor: not-allowed;
    }

    .consent-save-btn {
      margin-top: 0.85rem;
      width: 100%;
      min-height: 2.85rem;
      border: 1px solid rgba(244, 183, 63, 0.8);
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
      border-radius: 9px;
      padding: 0.68rem 0.9rem;
      font: inherit;
      font-weight: 700;
      cursor: pointer;
      transition: filter 130ms ease, transform 130ms ease;
    }

    .consent-save-btn:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
    }

    .welcome-popup-sound {
      margin-top: 0.88rem;
      padding-top: 0.85rem;
      border-top: 1px solid rgba(255, 255, 255, 0.16);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.7rem;
      flex-wrap: wrap;
    }

    .welcome-popup-sound p {
      margin: 0;
      color: #d9d3c0;
      font-size: 0.88rem;
    }

    .juleha-chat-window {
      position: fixed;
      right: 5.6rem;
      bottom: 9rem;
      z-index: 50;
      width: min(360px, calc(100vw - 2rem));
      height: 420px;
      border: 1px solid rgba(30, 184, 199, 0.5);
      border-radius: 14px;
      background:
        linear-gradient(155deg, rgba(30, 184, 199, 0.12), rgba(244, 183, 63, 0.08)),
        rgba(14, 12, 28, 0.96);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.42);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .juleha-chat-window[hidden] {
      display: none;
    }

    .juleha-chat-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.6rem;
      padding: 0.72rem 0.8rem;
      background: rgba(30, 184, 199, 0.14);
      border-bottom: 1px solid rgba(30, 184, 199, 0.35);
    }

    .juleha-chat-head h3 {
      margin: 0;
      font-size: 1rem;
      color: #b9f5ff;
    }

    .juleha-chat-meta {
      margin: 0;
      padding: 0.28rem 0.8rem 0.52rem;
      font-size: 0.73rem;
      color: rgba(185, 245, 255, 0.7);
      background: rgba(30, 184, 199, 0.08);
      border-bottom: 1px solid rgba(30, 184, 199, 0.2);
    }

    .juleha-chat-close {
      border: 1px solid rgba(255, 255, 255, 0.28);
      background: rgba(255, 255, 255, 0.08);
      color: #f8f7f5;
      border-radius: 8px;
      padding: 0.32rem 0.52rem;
      font: inherit;
      font-size: 0.84rem;
      font-weight: 600;
      cursor: pointer;
    }

    .juleha-chat-close:hover {
      filter: brightness(1.08);
    }

    .juleha-chat-log {
      flex: 1 1 auto;
      overflow-y: auto;
      padding: 0.8rem;
      display: flex;
      flex-direction: column;
      gap: 0.55rem;
    }

    .juleha-msg {
      margin: 0;
      max-width: 92%;
      padding: 0.52rem 0.68rem;
      border-radius: 10px;
      font-size: 0.9rem;
      line-height: 1.35;
      word-break: break-word;
    }

    .juleha-msg.assistant {
      align-self: flex-start;
      background: rgba(30, 184, 199, 0.16);
      border: 1px solid rgba(30, 184, 199, 0.35);
      color: #d8faff;
    }

    .juleha-msg.user {
      align-self: flex-end;
      background: rgba(244, 183, 63, 0.2);
      border: 1px solid rgba(244, 183, 63, 0.46);
      color: #fff4da;
    }

    .juleha-msg a {
      color: #9be8ff;
      text-decoration: underline;
      text-underline-offset: 2px;
    }

    .juleha-msg a:hover {
      color: #cbf5ff;
    }

    .juleha-chat-form {
      display: grid;
      grid-template-columns: minmax(0, 1fr) auto;
      gap: 0.48rem;
      padding: 0.72rem;
      border-top: 1px solid rgba(30, 184, 199, 0.35);
      background: rgba(0, 0, 0, 0.2);
    }

    .juleha-chat-input {
      border-radius: 9px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(10, 8, 19, 0.75);
      color: var(--ink);
      padding: 0.52rem 0.6rem;
      font: inherit;
      min-width: 0;
    }

    .juleha-chat-input::placeholder {
      color: rgba(248, 247, 245, 0.68);
    }

    .juleha-chat-send {
      border: 1px solid rgba(244, 183, 63, 0.8);
      background: linear-gradient(180deg, #f7ca6f, #f0a933);
      color: #1a1310;
      border-radius: 9px;
      padding: 0.52rem 0.72rem;
      font: inherit;
      font-weight: 700;
      width: 7.2rem;
      min-width: 7.2rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .juleha-chat-send:hover {
      filter: brightness(1.05);
    }

    .crazybunny-overlay {
      position: fixed;
      inset: 0;
      z-index: 60;
      background: #000;
      display: none;
      align-items: center;
      justify-content: center;
      pointer-events: none;
    }

    .crazybunny-overlay.is-active {
      display: flex;
    }

    .crazybunny-overlay img {
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      animation: crazybunny-shake 130ms linear infinite;
    }

    @keyframes crazybunny-shake {
      0% { transform: translateX(-5vw); }
      50% { transform: translateX(5vw); }
      100% { transform: translateX(-5vw); }
    }

    @media (max-width: 920px) {
      .hero {
        grid-template-columns: 1fr;
      }

      .hero-image-wrap {
        order: -1;
        max-height: 420px;
      }

      .tabs-top {
        flex-direction: column;
        align-items: stretch;
        gap: 0.62rem;
        padding: 0.72rem 0.72rem 0.62rem;
      }

      .tablist {
        flex: 0 0 auto;
      }

      .tab-search {
        margin-left: 0;
        min-width: 0;
        max-width: none;
        width: 100%;
        display: grid;
        grid-template-columns: minmax(0, 1fr) auto;
        gap: 0.5rem;
        align-items: center;
      }

      .tab-search .search-input {
        min-width: 0;
        width: 100%;
        height: 2.56rem;
        max-height: 2.56rem;
        padding-top: 0;
        padding-bottom: 0;
      }

      .tab-search .search-btn {
        height: 2.56rem;
        max-height: 2.56rem;
        padding: 0 0.95rem;
        line-height: 1;
      }

      .juleha-fab {
        right: 5.5rem;
        bottom: calc(1rem + 3.6rem);
        min-width: 8.7rem;
        height: 3.6rem;
      }

      .juleha-chat-window {
        right: 1rem;
        bottom: 8.6rem;
      }

      .ability-list {
        justify-content: flex-start;
      }

      .tool-detail-layout {
        grid-template-columns: 1fr;
      }

      .tool-detail-logo-wrap {
        min-height: 200px;
      }
    }

    @media (max-width: 680px) {
      .juleha-fab {
        right: 1rem;
        bottom: calc(1rem + 3.6rem);
      }

      .juleha-chat-window {
        right: 1rem;
        bottom: 8.6rem;
        width: calc(100vw - 2rem);
        height: min(420px, 60vh);
      }

      .consent-actions {
        grid-template-columns: minmax(0, 1fr);
      }

      .tool-detail-overlay {
        padding: 0.7rem;
      }

      .tool-detail-card {
        max-height: calc(100vh - 1.4rem);
      }

      .tool-detail-layout {
        padding: 0.9rem 0.82rem 0.92rem;
        gap: 0.8rem;
      }

      .tool-detail-logo-wrap {
        min-height: 170px;
      }

      .tool-detail-logo {
        max-height: 132px;
      }

      .tool-detail-logo-fallback {
        min-height: 128px;
      }

      .tool-detail-actions {
        margin-top: 0.78rem;
      }

      .tool-detail-open-link {
        width: 100%;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      .card,
      .tool-detail-card {
        transition: none;
        animation: none;
      }

      .tool-detail-overlay {
        transition: none;
      }
    }
  </style>
</head>
<body>
  <main class="container">
    <div id="app-version" class="app-version">v51</div>
    <section class="hero">
      <div class="hero-copy">
        <h1>AICENGHUB</h1>
        <p id="hero-description">Comprehensive AI tool directory for creation, automation, coding, learning, and inspiration. Each tool appears once, and filters/search help you find the best fit quickly.</p>
        <div id="lang-switch" class="lang-switch" role="group" aria-label="Language selector">
          <button class="lang-btn" type="button" data-lang="en" aria-pressed="true">EN</button>
          <button class="lang-btn" type="button" data-lang="id" aria-pressed="false">ID</button>
        </div>
        <div class="hero-controls">
          <button
            id="music-toggle-hero"
            class="music-toggle"
            type="button"
            aria-label="Toggle background sound"
            aria-pressed="false">
            Play Sound
          </button>
        </div>
      </div>
      <figure class="hero-image-wrap">
        <img id="hero-image" src="./suhuaiceng.jpg" alt="Shifu portrait">
      </figure>
    </section>

    <section class="tabs-shell">
      <div class="tabs-top">
        <div id="tablist" class="tablist" role="toolbar" aria-label="AI ability filters"></div>
        <div id="search-shell" class="search-bar tab-search" aria-label="AI tool search">
          <input id="global-search-input" class="search-input" type="search" autocomplete="off" placeholder="Search name, abilities, or keywords...">
          <button id="global-search-btn" class="search-btn" type="button">Search</button>
        </div>
      </div>
      <article class="panel" id="directory-panel" aria-live="polite">
        <div class="panel-head">
          <h2 id="panel-title">Master AI Directory</h2>
          <p id="panel-subtitle">Use tabs as one-click ability filters. Search applies on top of the selected filter.</p>
        </div>
        <p id="search-status" class="search-status">Loading tools...</p>
        <div id="tool-grid" class="grid"></div>
      </article>
    </section>

    <footer class="footer-shell">
      <p id="footer-title" class="footer-title">AICENGHUB — AI-Curated Evolving Network of Generative Hubs</p>
      <p id="footer-subtitle" class="footer-subtitle">A continuously updated AI tools directory.</p>
      <div class="footer-links">
        <button id="privacy-settings-trigger" class="footer-link-btn" type="button">Privacy Settings</button>
        <span class="footer-dot" aria-hidden="true">·</span>
        <a id="legal-link-footer" class="footer-link-anchor" href="./legal.html" target="_blank" rel="noopener noreferrer">Full Agreement</a>
        <span class="footer-dot" aria-hidden="true">·</span>
        <a class="footer-link-anchor" href="mailto:contact@aicenghub.web.id">contact@aicenghub.web.id</a>
      </div>
      <p id="footer-copyright" class="footer-meta">© 2026 AICENGHUB</p>
      <p id="footer-credit" class="footer-meta">Built by Murid SUHU AICENG</p>
    </footer>
  </main>
  <section id="tool-detail-overlay" class="tool-detail-overlay" aria-hidden="true" hidden>
    <article class="tool-detail-card" role="dialog" aria-modal="true" aria-labelledby="tool-detail-title">
      <button id="tool-detail-close" class="tool-detail-close" type="button" aria-label="Close details">x</button>
      <div class="tool-detail-layout">
        <aside class="tool-detail-visual" aria-label="Tool visual">
          <div class="tool-detail-logo-wrap">
            <img id="tool-detail-logo" class="tool-detail-logo" src="" alt="">
            <div id="tool-detail-logo-fallback" class="tool-detail-logo-fallback" hidden>AI</div>
          </div>
          <div class="tool-detail-favicon-row">
            <img id="tool-detail-favicon" class="tool-detail-favicon" src="" alt="">
            <span id="tool-detail-domain" class="tool-detail-domain">-</span>
          </div>
        </aside>
        <section class="tool-detail-main">
          <p id="tool-detail-eyebrow" class="tool-detail-eyebrow">AI Tool Spotlight</p>
          <h3 id="tool-detail-title" class="tool-detail-title">Tool Name</h3>
          <p id="tool-detail-description" class="tool-detail-description"></p>

          <div class="tool-detail-sections">
            <div class="tool-detail-block">
              <strong id="tool-detail-pricing-heading">Pricing</strong>
              <div id="tool-detail-pricing-row" class="pricing-row tool-detail-pricing-row"></div>
            </div>
            <div class="tool-detail-block">
              <strong id="tool-detail-abilities-heading">Abilities</strong>
              <div id="tool-detail-abilities" class="tool-detail-pill-list"></div>
            </div>
            <div class="tool-detail-block">
              <strong id="tool-detail-tags-heading">Tags</strong>
              <div id="tool-detail-tags" class="tool-detail-pill-list"></div>
            </div>
          </div>

          <div class="tool-detail-actions">
            <a id="tool-detail-open-link" class="tool-detail-open-link" href="#" target="_blank" rel="noopener noreferrer">Open Link</a>
          </div>
        </section>
      </div>
    </article>
  </section>
  <button id="bunny-fab" class="bunny-fab" type="button" aria-label="Bunny">
    <img src="./transparentbunny.png" alt="" aria-hidden="true">
  </button>
  <button
    id="juleha-fab"
    class="juleha-fab"
    type="button"
    aria-label="Open Ask Juleha chat"
    aria-expanded="false"
    aria-controls="juleha-chat-window">
    Ask Juleha
  </button>
  <section id="juleha-chat-window" class="juleha-chat-window" aria-label="Ask Juleha chat window" hidden>
    <header class="juleha-chat-head">
      <h3>Ask Juleha</h3>
      <button id="juleha-chat-close" class="juleha-chat-close" type="button" aria-label="Close chat">Close</button>
    </header>
    <p id="juleha-chat-meta" class="juleha-chat-meta">Powered by: loading...</p>
    <div id="juleha-chat-log" class="juleha-chat-log" role="log" aria-live="polite"></div>
    <form id="juleha-chat-form" class="juleha-chat-form">
      <input id="juleha-chat-input" class="juleha-chat-input" type="text" maxlength="500" placeholder="Type your message..." autocomplete="off">
      <button class="juleha-chat-send" type="submit">Send</button>
    </form>
  </section>
  <div id="crazybunny-overlay" class="crazybunny-overlay" aria-hidden="true">
    <img src="./crazybunny.jpg" alt="" aria-hidden="true">
  </div>
  <section id="welcome-popup" class="welcome-popup" aria-label="Website consent and privacy settings" hidden>
    <div class="welcome-popup-card">
      <h3 id="consent-title">Welcome to AICENGHUB</h3>
      <p id="consent-description">AICENGHUB processes chat messages through third-party AI providers and stores AI-generated or user-suggested tool links to keep the directory up to date. Essential processing is required for the platform to function.</p>
      <div class="consent-legal-row">
        <a id="consent-legal-link" class="consent-legal-link" href="./legal.html" target="_blank" rel="noopener noreferrer">See full agreement</a>
        <button id="consent-lang-toggle" class="consent-lang-toggle" type="button" aria-label="Switch language to Indonesian">EN</button>
      </div>
      <div class="consent-actions">
        <button id="consent-accept-btn" class="consent-btn primary" type="button">Agree &amp; Continue</button>
        <button id="consent-manage-btn" class="consent-btn" type="button">Manage Settings</button>
      </div>
      <section id="consent-settings" class="consent-settings" hidden>
        <div class="consent-setting-item">
          <div>
            <strong id="consent-essential-label">Essential (Always Active)</strong>
            <p id="consent-essential-description">Required for operating AICENGHUB, including AI chat processing, security protection, and capturing AI-generated or user-suggested tool links to improve the directory.</p>
          </div>
          <div class="consent-toggle-wrap">
            <input id="consent-essential-toggle" class="consent-switch" type="checkbox" checked disabled>
          </div>
        </div>
        <div class="consent-setting-item">
          <div>
            <strong id="consent-analytics-label">Analytics</strong>
            <p id="consent-analytics-description">Used to understand usage trends and improve platform performance.</p>
          </div>
          <div class="consent-toggle-wrap">
            <input id="consent-analytics-toggle" class="consent-switch" type="checkbox">
          </div>
        </div>
        <div class="consent-setting-item">
          <div>
            <strong id="consent-personalization-label">Personalization</strong>
            <p id="consent-personalization-description">Stores language and sound preferences on this device.</p>
          </div>
          <div class="consent-toggle-wrap">
            <input id="consent-personalization-toggle" class="consent-switch" type="checkbox" checked>
          </div>
        </div>
        <div class="welcome-popup-sound">
          <p id="consent-sound-tip">Suggested: turn on sound for full experience.</p>
          <button
            id="music-toggle-popup"
            class="music-toggle"
            type="button"
            aria-label="Toggle background sound from consent popup"
            aria-pressed="false">
            Play Sound
          </button>
        </div>
        <button id="consent-save-btn" class="consent-save-btn" type="button">Save Preferences</button>
      </section>
    </div>
  </section>

  <script>
    const ABILITY_FILTER_KEYS = ["all", "text", "image", "video", "audio", "code", "automation", "learning"];
    const I18N = {
      en: {
        htmlLang: "en",
        heroDescription: "Comprehensive AI tool directory for creation, automation, coding, learning, and inspiration. Each tool appears once, and filters/search help you find the best fit quickly.",
        heroImageAlt: "Shifu portrait",
        searchPlaceholder: "Search name, abilities, or keywords...",
        searchButton: "Search",
        panelTitle: "Master AI Directory",
        panelSubtitle: "Use tabs as quick filters. When you type in search, results are matched across all tools.",
        loadingTools: "Loading tools...",
        footerTitle: "AICENGHUB — AI-Curated Evolving Network of Generative Hubs",
        footerSubtitle: "A continuously updated AI tools directory.",
        footerCopyright: "© 2026 AICENGHUB",
        footerCredit: "Built by Murid SUHU AICENG",
        privacySettingsLabel: "Privacy Settings",
        legalLinkLabel: "Full Agreement",
        filterBarLabel: "AI ability filters",
        searchBarLabel: "AI tool search",
        languageSwitchLabel: "Language selector",
        openLink: "Open Link",
        toolDetail: {
          eyebrow: "AI Tool Spotlight",
          pricingHeading: "Pricing",
          abilitiesHeading: "Abilities",
          tagsHeading: "Tags",
          closeLabel: "Close details",
          openLink: "Open Official Site"
        },
        pricingLabels: {
          free: "Free",
          trial: "Free Trial",
          paid: "Paid"
        },
        tagLabels: {
          watermarked: "Watermarked"
        },
        noMatchingTitle: "No matching tools",
        noMatchingDescription: "Try a different filter or broader search keyword.",
        loadError: "Unable to load main list from database.",
        consent: {
          title: "Welcome to AICENGHUB",
          description: "AICENGHUB processes chat messages through third-party AI providers and stores AI-generated or user-suggested tool links to keep the directory up to date. Essential processing is required for the platform to function.",
          agreeContinue: "Agree & Continue",
          manageSettings: "Manage Settings",
          savePreferences: "Save Preferences",
          legalLink: "See full agreement",
          essentialLabel: "Essential (Always Active)",
          essentialDescription: "Required for operating AICENGHUB, including AI chat processing, security protection, and capturing AI-generated or user-suggested tool links to improve the directory.",
          analyticsLabel: "Analytics",
          analyticsDescription: "Used to understand usage trends and improve platform performance.",
          personalizationLabel: "Personalization",
          personalizationDescription: "Stores language and sound preferences on this device.",
          soundTip: "Suggested: turn on sound for full experience.",
          switchToEnglish: "Switch language to English",
          switchToIndonesian: "Switch language to Indonesian"
        },
        abilityLabels: {
          all: "ALL",
          text: "TEXT",
          image: "IMAGE",
          video: "VIDEO",
          audio: "AUDIO",
          code: "CODE",
          automation: "AUTOMATION",
          learning: "LEARNING"
        },
        status(shown, total, activeLabel, query) {
          const searchPart = query ? ` and search "${query}"` : "";
          return `Showing ${shown} of ${total} tools for filter "${activeLabel}"${searchPart}.`;
        }
      },
      id: {
        htmlLang: "id",
        heroDescription: "Direktori alat AI lengkap untuk kreasi, otomasi, coding, pembelajaran, dan inspirasi. Setiap alat hanya muncul sekali, dan filter/pencarian membantu Anda menemukan yang paling sesuai dengan cepat.",
        heroImageAlt: "Potret Shifu",
        searchPlaceholder: "Cari nama, kemampuan, atau kata kunci...",
        searchButton: "Cari",
        panelTitle: "Direktori AI Utama",
        panelSubtitle: "Gunakan tab sebagai filter cepat. Saat Anda mengetik pada pencarian, hasil dicocokkan ke semua alat.",
        loadingTools: "Memuat alat...",
        footerTitle: "AICENGHUB-Adalah Integrasi Cerdas Ekosistem Network Generatif Hub",
        footerSubtitle: "Daftar AI Terbarui Automatis",
        footerCopyright: "© 2026 AICENGHUB",
        footerCredit: "Built by Murid SUHU AICENG",
        privacySettingsLabel: "Pengaturan Privasi",
        legalLinkLabel: "Perjanjian Lengkap",
        filterBarLabel: "Filter kemampuan AI",
        searchBarLabel: "Pencarian alat AI",
        languageSwitchLabel: "Pemilih bahasa",
        openLink: "Buka Tautan",
        toolDetail: {
          eyebrow: "Sorotan Alat AI",
          pricingHeading: "Harga",
          abilitiesHeading: "Kemampuan",
          tagsHeading: "Tag",
          closeLabel: "Tutup detail",
          openLink: "Buka Situs Resmi"
        },
        pricingLabels: {
          free: "Gratis",
          trial: "Uji Coba",
          paid: "Berbayar"
        },
        tagLabels: {
          watermarked: "Ber-watermark"
        },
        noMatchingTitle: "Tidak ada alat yang cocok",
        noMatchingDescription: "Coba filter lain atau kata kunci yang lebih umum.",
        loadError: "Tidak dapat memuat daftar utama dari database.",
        consent: {
          title: "Selamat Datang di AICENGHUB",
          description: "AICENGHUB memproses pesan melalui penyedia AI pihak ketiga dan menyimpan link AI yang dihasilkan atau disarankan untuk menjaga direktori tetap terbaru. Pemrosesan penting diperlukan agar platform berfungsi.",
          agreeContinue: "Setuju & Lanjutkan",
          manageSettings: "Kelola Pengaturan",
          savePreferences: "Simpan Preferensi",
          legalLink: "Lihat perjanjian lengkap",
          essentialLabel: "Esensial (Selalu Aktif)",
          essentialDescription: "Diperlukan untuk menjalankan AICENGHUB, termasuk pemrosesan chat AI, perlindungan keamanan, dan penyimpanan link AI yang dihasilkan atau disarankan untuk peningkatan direktori.",
          analyticsLabel: "Analitik",
          analyticsDescription: "Digunakan untuk memahami tren penggunaan dan meningkatkan performa platform.",
          personalizationLabel: "Personalisasi",
          personalizationDescription: "Menyimpan preferensi bahasa dan suara pada perangkat ini.",
          soundTip: "Saran: nyalakan suara untuk pengalaman penuh.",
          switchToEnglish: "Ganti bahasa ke English",
          switchToIndonesian: "Ganti bahasa ke Indonesia"
        },
        abilityLabels: {
          all: "SEMUA",
          text: "TEKS",
          image: "GAMBAR",
          video: "VIDEO",
          audio: "AUDIO",
          code: "KODE",
          automation: "OTOMASI",
          learning: "PEMBELAJARAN"
        },
        status(shown, total, activeLabel, query) {
          const searchPart = query ? ` dan pencarian "${query}"` : "";
          return `Menampilkan ${shown} dari ${total} alat untuk filter "${activeLabel}"${searchPart}.`;
        }
      }
    };

    const tablist = document.getElementById("tablist");
    const toolGrid = document.getElementById("tool-grid");
    const searchStatus = document.getElementById("search-status");
    const globalSearchInput = document.getElementById("global-search-input");
    const globalSearchBtn = document.getElementById("global-search-btn");
    const heroDescription = document.getElementById("hero-description");
    const heroImage = document.getElementById("hero-image");
    const searchShell = document.getElementById("search-shell");
    const panelTitle = document.getElementById("panel-title");
    const panelSubtitle = document.getElementById("panel-subtitle");
    const footerTitle = document.getElementById("footer-title");
    const footerSubtitle = document.getElementById("footer-subtitle");
    const footerCopyright = document.getElementById("footer-copyright");
    const footerCredit = document.getElementById("footer-credit");
    const privacySettingsTrigger = document.getElementById("privacy-settings-trigger");
    const legalLinkFooter = document.getElementById("legal-link-footer");
    const appVersion = document.getElementById("app-version");
    const langSwitch = document.getElementById("lang-switch");
    const bunnyFab = document.getElementById("bunny-fab");
    const musicToggleHero = document.getElementById("music-toggle-hero");
    const musicTogglePopup = document.getElementById("music-toggle-popup");
    const welcomePopup = document.getElementById("welcome-popup");
    const consentTitle = document.getElementById("consent-title");
    const consentDescription = document.getElementById("consent-description");
    const consentLegalLink = document.getElementById("consent-legal-link");
    const consentLangToggle = document.getElementById("consent-lang-toggle");
    const consentAcceptButton = document.getElementById("consent-accept-btn");
    const consentManageButton = document.getElementById("consent-manage-btn");
    const consentSettings = document.getElementById("consent-settings");
    const consentEssentialLabel = document.getElementById("consent-essential-label");
    const consentEssentialDescription = document.getElementById("consent-essential-description");
    const consentAnalyticsLabel = document.getElementById("consent-analytics-label");
    const consentAnalyticsDescription = document.getElementById("consent-analytics-description");
    const consentPersonalizationLabel = document.getElementById("consent-personalization-label");
    const consentPersonalizationDescription = document.getElementById("consent-personalization-description");
    const consentSoundTip = document.getElementById("consent-sound-tip");
    const consentEssentialToggle = document.getElementById("consent-essential-toggle");
    const consentAnalyticsToggle = document.getElementById("consent-analytics-toggle");
    const consentPersonalizationToggle = document.getElementById("consent-personalization-toggle");
    const consentSaveButton = document.getElementById("consent-save-btn");
    const toolDetailOverlay = document.getElementById("tool-detail-overlay");
    const toolDetailCard = toolDetailOverlay.querySelector(".tool-detail-card");
    const toolDetailCloseButton = document.getElementById("tool-detail-close");
    const toolDetailLogo = document.getElementById("tool-detail-logo");
    const toolDetailLogoFallback = document.getElementById("tool-detail-logo-fallback");
    const toolDetailFavicon = document.getElementById("tool-detail-favicon");
    const toolDetailDomain = document.getElementById("tool-detail-domain");
    const toolDetailEyebrow = document.getElementById("tool-detail-eyebrow");
    const toolDetailTitle = document.getElementById("tool-detail-title");
    const toolDetailDescription = document.getElementById("tool-detail-description");
    const toolDetailPricingHeading = document.getElementById("tool-detail-pricing-heading");
    const toolDetailPricingRow = document.getElementById("tool-detail-pricing-row");
    const toolDetailAbilitiesHeading = document.getElementById("tool-detail-abilities-heading");
    const toolDetailAbilities = document.getElementById("tool-detail-abilities");
    const toolDetailTagsHeading = document.getElementById("tool-detail-tags-heading");
    const toolDetailTags = document.getElementById("tool-detail-tags");
    const toolDetailOpenLink = document.getElementById("tool-detail-open-link");
    const julehaFab = document.getElementById("juleha-fab");
    const julehaChatWindow = document.getElementById("juleha-chat-window");
    const julehaChatClose = document.getElementById("juleha-chat-close");
    const julehaChatMeta = document.getElementById("juleha-chat-meta");
    const julehaChatLog = document.getElementById("juleha-chat-log");
    const julehaChatForm = document.getElementById("juleha-chat-form");
    const julehaChatInput = document.getElementById("juleha-chat-input");
    const julehaChatSendButton = julehaChatForm.querySelector(".juleha-chat-send");
    const crazybunnyOverlay = document.getElementById("crazybunny-overlay");
    const crazybunnyImage = crazybunnyOverlay.querySelector("img");
    const crazybunnySound = new Audio("./bunnygrowl.mp4");
    crazybunnySound.preload = "auto";
    crazybunnySound.load();
    const musicTracks = ["./ost1.mp3", "./ost2.mp3"];
    const backgroundMusic = new Audio();
    backgroundMusic.preload = "auto";
    backgroundMusic.volume = 0.33;
    let currentMusicTrack = "";

    let tools = [];
    let activeFilter = "all";
    let searchQuery = "";
    let searchDebounceTimer = null;
    let crazybunnyTimer = null;
    let crazybunnyPreloadedImage = null;
    let activeToolDetail = null;
    let activeToolDetailTrigger = null;
    let toolDetailOpenAnimation = null;
    let isToolDetailClosing = false;
    let currentLanguage = detectInitialLanguage();
    let isJulehaRequestInFlight = false;
    let julehaActiveRouteLabel = "loading...";
    let julehaThinkingDotsTimer = null;
    let julehaThinkingDotsStep = 0;
    const JULEHA_API_ENDPOINT = "/api/juleha-chat";
    const JULEHA_MEMORY_TURNS = 12;
    const JULEHA_HISTORY_STORAGE_KEY = "aicenghub.juleha.history.v2";
    const JULEHA_MAX_HISTORY_MESSAGES = JULEHA_MEMORY_TURNS * 2;
    const JULEHA_MAX_HISTORY_ITEM_CHARS = 320;
    const JULEHA_MAX_CATALOG_ITEMS = 8;
    const JULEHA_SYSTEM_PROMPT = [
      "You are Juleha, the AI copilot inside AICENGHUB.",
      "Persona: calm, tactical, slightly playful, and focused on helping the user decide quickly.",
      "Style rules: concise, practical, no fluff, and prefer short lists when useful.",
      "Capability: use server-side URL checks for specific links when user asks to verify/browse links.",
      "If user asks whether you can browse/check, explain you can verify provided URLs and ask for exact links when needed.",
      "Priority: recommend tools from AICENGHUB catalog first and include their direct links.",
      "When offering options, always prefer this order: free first, then trial, then paid.",
      "If a user asks for an AI that is not in catalog, you may use your own knowledge to suggest external tools.",
      "When suggesting external tools, clearly label them as external (not in AICENGHUB catalog).",
      "If possible, still include closest in-catalog alternatives."
    ].join(" ");
    let julehaHistory = loadJulehaHistory();
    const BUNNY_HIDDEN_COOKIE_NAME = "aicenghub_bunny_hidden";
    const BUNNY_SEEN_COOKIE_NAME = "aicenghub_bunny_seen";
    const BUNNY_HIDE_DAYS = 365;
    const BUNNY_RETURN_CHANCE = 0.05;
    const CONSENT_STORAGE_KEY = "aicenghub_consent";
    const MUSIC_PREFERENCE_KEY = "aicenghub.music.enabled";
    let consentState = loadConsentState();
    let musicEnabled = loadMusicPreference();
    const ABILITY_SEARCH_ALIASES = {
      all: ["all", "semua", "any"],
      text: ["text", "teks", "chat", "tulis", "writing"],
      image: ["image", "gambar", "photo", "foto", "visual", "art"],
      video: ["video", "vid", "film", "klip", "clip"],
      audio: ["audio", "musik", "music", "song", "suara", "voice"],
      code: ["code", "kode", "coding", "programming", "developer", "dev"],
      automation: ["automation", "otomasi", "workflow", "agent", "integrasi", "integration"],
      learning: ["learning", "belajar", "tutorial", "research", "edukasi", "education"]
    };
    const ALLOWED_ABILITIES = new Set(Object.keys(ABILITY_SEARCH_ALIASES).filter((ability) => ability !== "all"));
    const PRICING_TIER_ORDER = { free: 0, trial: 1, paid: 2 };
    const PRICING_SEARCH_ALIASES = {
      free: ["free", "gratis", "no-cost", "tanpa-biaya"],
      trial: ["trial", "freemium", "coba", "uji-coba"],
      paid: ["paid", "berbayar", "premium", "pro-only"]
    };
    const ALLOWED_TOOL_TAGS = new Set(["watermarked"]);
    const TAG_SEARCH_ALIASES = {
      watermarked: ["watermarked", "watermark", "wm", "ber-watermark", "bertanda-air"]
    };
    const TAG_TO_ABILITIES = {
      text: ["text"],
      image: ["image"],
      video: ["video"],
      audio: ["audio"],
      code: ["code"],
      automation: ["automation"],
      learning: ["learning"],
      research: ["learning"],
      reasoning: ["learning"],
      multimodal_reasoning: ["learning"],
      long_context: ["learning"],
      design: ["image"],
      editing: ["image"],
      music: ["audio"],
      sfx: ["audio"],
      speech: ["audio"],
      app: ["code"],
      avatar: ["video"],
      watermarked: ["image", "video"]
    };
    const SEARCH_TOKEN_TO_ABILITY = Object.entries(ABILITY_SEARCH_ALIASES)
      .reduce((accumulator, [ability, aliases]) => {
        aliases.forEach((alias) => {
          accumulator[alias] = ability;
        });
        return accumulator;
      }, {});
    const SEARCH_TOKEN_TO_PRICING = Object.entries(PRICING_SEARCH_ALIASES)
      .reduce((accumulator, [tier, aliases]) => {
        aliases.forEach((alias) => {
          accumulator[alias] = tier;
        });
        return accumulator;
      }, {});
    const SEARCH_TOKEN_TO_TAG = Object.entries(TAG_SEARCH_ALIASES)
      .reduce((accumulator, [tag, aliases]) => {
        aliases.forEach((alias) => {
          accumulator[alias] = tag;
        });
        return accumulator;
      }, {});

    function getDictionary() {
      return I18N[currentLanguage] || I18N.en;
    }

    function getAbilityLabel(filterKey) {
      return getDictionary().abilityLabels[filterKey] || String(filterKey || "").toUpperCase();
    }

    function normalizePricingTier(rawPricing) {
      const raw = normalize(rawPricing).replace(/\s+/g, "-");
      if (raw === "free" || raw === "full-free" || raw === "totally-free" || raw === "gratis") return "free";
      if (raw === "trial" || raw === "free-trial" || raw === "freemium" || raw === "uji-coba") return "trial";
      if (raw === "paid" || raw === "full-paid" || raw === "berbayar" || raw === "premium") return "paid";
      return "trial";
    }

    function getPricingRank(pricingTier) {
      const normalized = normalizePricingTier(pricingTier);
      return Number.isInteger(PRICING_TIER_ORDER[normalized]) ? PRICING_TIER_ORDER[normalized] : 99;
    }

    function getPricingLabel(pricingTier) {
      const normalized = normalizePricingTier(pricingTier);
      const labels = getDictionary().pricingLabels || I18N.en.pricingLabels;
      return labels[normalized] || labels.trial;
    }

    function normalizeToolTags(rawTags) {
      if (!Array.isArray(rawTags)) return [];
      const normalized = [];
      const seen = new Set();
      rawTags.forEach((rawTag) => {
        const tag = normalize(rawTag).replace(/\s+/g, "-");
        if (!ALLOWED_TOOL_TAGS.has(tag)) return;
        if (seen.has(tag)) return;
        seen.add(tag);
        normalized.push(tag);
      });
      return normalized;
    }

    function getTagLabel(tagKey) {
      const labels = getDictionary().tagLabels || I18N.en.tagLabels;
      return labels[tagKey] || String(tagKey || "").replace(/-/g, " ");
    }

    function extractHostname(rawUrl) {
      try {
        const parsed = new URL(String(rawUrl || ""));
        return parsed.hostname.replace(/^www\./i, "");
      } catch {
        return "";
      }
    }

    function getToolInitials(name) {
      const tokens = String(name || "")
        .trim()
        .split(/\s+/)
        .filter(Boolean);
      if (!tokens.length) return "AI";
      if (tokens.length === 1) return tokens[0].slice(0, 2).toUpperCase();
      return `${tokens[0][0] || ""}${tokens[1][0] || ""}`.toUpperCase();
    }

    function createDetailAbilityTag(ability) {
      const chip = document.createElement("span");
      chip.className = "tool-detail-ability-tag";
      chip.textContent = getAbilityLabel(ability);
      return chip;
    }

    function applyToolDetailTranslations() {
      const detail = getDictionary().toolDetail || I18N.en.toolDetail;
      toolDetailEyebrow.textContent = detail.eyebrow;
      toolDetailPricingHeading.textContent = detail.pricingHeading;
      toolDetailAbilitiesHeading.textContent = detail.abilitiesHeading;
      toolDetailTagsHeading.textContent = detail.tagsHeading;
      toolDetailOpenLink.textContent = detail.openLink;
      toolDetailCloseButton.setAttribute("aria-label", detail.closeLabel);
      toolDetailCloseButton.title = detail.closeLabel;
    }

    function populateToolDetailModal(tool) {
      if (!tool) return;
      activeToolDetail = tool;
      applyToolDetailTranslations();

      toolDetailTitle.textContent = tool.name || "Unknown Tool";
      toolDetailDescription.textContent = tool.description || "-";

      toolDetailPricingRow.innerHTML = "";
      const pricingPill = createPricingPill(tool.pricing);
      const pricingText = document.createElement("span");
      pricingText.className = "pricing-text";
      pricingText.textContent = getPricingLabel(tool.pricing);
      toolDetailPricingRow.append(pricingPill, pricingText);

      toolDetailAbilities.innerHTML = "";
      const abilities = Array.isArray(tool.abilities) ? tool.abilities : [];
      if (abilities.length) {
        abilities.forEach((ability) => {
          toolDetailAbilities.appendChild(createDetailAbilityTag(ability));
        });
      } else {
        const noneAbility = document.createElement("span");
        noneAbility.className = "tool-detail-ability-tag";
        noneAbility.textContent = "-";
        toolDetailAbilities.appendChild(noneAbility);
      }

      toolDetailTags.innerHTML = "";
      if (Array.isArray(tool.tags) && tool.tags.length) {
        tool.tags.forEach((tag) => {
          toolDetailTags.appendChild(createToolTag(tag));
        });
      } else {
        const noneTag = document.createElement("span");
        noneTag.className = "tool-detail-ability-tag";
        noneTag.textContent = "-";
        toolDetailTags.appendChild(noneTag);
      }

      const safeUrl = sanitizeUrl(tool.url);
      const hostname = extractHostname(safeUrl);
      toolDetailDomain.textContent = hostname || "unknown-domain";

      if (safeUrl === "#") {
        toolDetailOpenLink.href = "#";
        toolDetailOpenLink.setAttribute("aria-disabled", "true");
        toolDetailOpenLink.style.opacity = "0.6";
        toolDetailOpenLink.style.pointerEvents = "none";
      } else {
        toolDetailOpenLink.href = safeUrl;
        toolDetailOpenLink.removeAttribute("aria-disabled");
        toolDetailOpenLink.style.opacity = "";
        toolDetailOpenLink.style.pointerEvents = "";
      }

      const initials = getToolInitials(tool.name);
      toolDetailLogoFallback.textContent = initials;
      toolDetailLogoFallback.hidden = false;
      toolDetailLogo.hidden = true;

      toolDetailFavicon.hidden = !hostname;
      toolDetailFavicon.alt = hostname ? `${hostname} favicon` : "";
      toolDetailFavicon.src = hostname
        ? `https://www.google.com/s2/favicons?domain=${encodeURIComponent(hostname)}&sz=128`
        : "";
      toolDetailFavicon.onerror = () => {
        toolDetailFavicon.hidden = true;
      };

      if (!hostname) {
        toolDetailLogo.removeAttribute("src");
        toolDetailLogo.alt = "";
        return;
      }

      toolDetailLogo.alt = `${tool.name} logo`;
      toolDetailLogo.src = `https://logo.clearbit.com/${hostname}`;
      toolDetailLogo.hidden = false;
      toolDetailLogo.onload = () => {
        toolDetailLogoFallback.hidden = true;
      };
      toolDetailLogo.onerror = () => {
        toolDetailLogo.hidden = true;
        toolDetailLogoFallback.hidden = false;
      };
    }

    function prefersReducedMotion() {
      return window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    }

    function animateToolDetailOpenFromCard(triggerNode) {
      if (!toolDetailCard) return;
      if (!triggerNode || !(triggerNode instanceof Element)) return;
      if (prefersReducedMotion()) return;

      const sourceRect = triggerNode.getBoundingClientRect();
      const targetRect = toolDetailCard.getBoundingClientRect();
      if (!sourceRect.width || !sourceRect.height || !targetRect.width || !targetRect.height) return;

      const sourceCenterX = sourceRect.left + (sourceRect.width / 2);
      const sourceCenterY = sourceRect.top + (sourceRect.height / 2);
      const targetCenterX = targetRect.left + (targetRect.width / 2);
      const targetCenterY = targetRect.top + (targetRect.height / 2);

      const translateX = sourceCenterX - targetCenterX;
      const translateY = sourceCenterY - targetCenterY;
      const scaleX = Math.max(0.24, Math.min(1, sourceRect.width / targetRect.width));
      const scaleY = Math.max(0.2, Math.min(1, sourceRect.height / targetRect.height));

      if (toolDetailOpenAnimation) {
        try {
          toolDetailOpenAnimation.cancel();
        } catch {}
      }

      toolDetailCard.style.willChange = "transform, opacity, filter";
      toolDetailOpenAnimation = toolDetailCard.animate(
        [
          {
            transform: `translate(${translateX}px, ${translateY}px) scale(${scaleX}, ${scaleY})`,
            opacity: 0.78,
            filter: "saturate(0.92)"
          },
          {
            transform: "translate(0px, 0px) scale(1, 1)",
            opacity: 1,
            filter: "saturate(1)"
          }
        ],
        {
          duration: 260,
          easing: "cubic-bezier(0.22, 0.61, 0.36, 1)",
          fill: "both"
        }
      );

      toolDetailOpenAnimation.finished
        .catch(() => {})
        .finally(() => {
          toolDetailCard.style.willChange = "";
          toolDetailCard.style.transform = "";
          toolDetailCard.style.opacity = "";
          toolDetailCard.style.filter = "";
          toolDetailOpenAnimation = null;
        });
    }

    function animateToolDetailCloseToCard(triggerNode) {
      if (!toolDetailCard) return Promise.resolve();
      if (!triggerNode || !(triggerNode instanceof Element)) return Promise.resolve();
      if (prefersReducedMotion()) return Promise.resolve();

      const sourceRect = triggerNode.getBoundingClientRect();
      const targetRect = toolDetailCard.getBoundingClientRect();
      if (!sourceRect.width || !sourceRect.height || !targetRect.width || !targetRect.height) {
        return Promise.resolve();
      }

      const sourceCenterX = sourceRect.left + (sourceRect.width / 2);
      const sourceCenterY = sourceRect.top + (sourceRect.height / 2);
      const targetCenterX = targetRect.left + (targetRect.width / 2);
      const targetCenterY = targetRect.top + (targetRect.height / 2);

      const translateX = sourceCenterX - targetCenterX;
      const translateY = sourceCenterY - targetCenterY;
      const scaleX = Math.max(0.24, Math.min(1, sourceRect.width / targetRect.width));
      const scaleY = Math.max(0.2, Math.min(1, sourceRect.height / targetRect.height));

      if (toolDetailOpenAnimation) {
        try {
          toolDetailOpenAnimation.cancel();
        } catch {}
      }

      toolDetailCard.style.willChange = "transform, opacity, filter";
      toolDetailOpenAnimation = toolDetailCard.animate(
        [
          {
            transform: "translate(0px, 0px) scale(1, 1)",
            opacity: 1,
            filter: "saturate(1)"
          },
          {
            transform: `translate(${translateX}px, ${translateY}px) scale(${scaleX}, ${scaleY})`,
            opacity: 0.76,
            filter: "saturate(0.92)"
          }
        ],
        {
          duration: 220,
          easing: "cubic-bezier(0.4, 0, 0.2, 1)",
          fill: "both"
        }
      );

      return toolDetailOpenAnimation.finished
        .catch(() => {})
        .finally(() => {
          if (!toolDetailCard) return;
          toolDetailCard.style.willChange = "";
          toolDetailCard.style.transform = "";
          toolDetailCard.style.opacity = "";
          toolDetailCard.style.filter = "";
          toolDetailOpenAnimation = null;
        });
    }

    function finalizeToolDetailClose() {
      toolDetailOverlay.hidden = true;
      toolDetailOverlay.setAttribute("aria-hidden", "true");
      document.body.classList.remove("tool-detail-open");
      if (activeToolDetailTrigger && typeof activeToolDetailTrigger.focus === "function") {
        activeToolDetailTrigger.focus();
      }
      activeToolDetailTrigger = null;
      isToolDetailClosing = false;
    }

    function openToolDetailModal(tool, triggerNode) {
      populateToolDetailModal(tool);
      activeToolDetailTrigger = triggerNode || null;
      toolDetailOverlay.hidden = false;
      toolDetailOverlay.setAttribute("aria-hidden", "false");
      document.body.classList.add("tool-detail-open");
      requestAnimationFrame(() => {
        toolDetailOverlay.classList.add("is-open");
        animateToolDetailOpenFromCard(activeToolDetailTrigger);
      });
      window.setTimeout(() => {
        toolDetailCloseButton.focus();
      }, 0);
    }

    function closeToolDetailModal(options = {}) {
      if (toolDetailOverlay.hidden) return;
      if (isToolDetailClosing) return;
      isToolDetailClosing = true;
      const reverseToCard = Boolean(options && options.reverseToCard);

      const canReverse = reverseToCard
        && activeToolDetailTrigger
        && activeToolDetailTrigger instanceof Element
        && document.contains(activeToolDetailTrigger)
        && !prefersReducedMotion();

      toolDetailOverlay.classList.remove("is-open");
      if (canReverse) {
        animateToolDetailCloseToCard(activeToolDetailTrigger).finally(() => {
          finalizeToolDetailClose();
        });
        return;
      }

      if (toolDetailOpenAnimation) {
        try {
          toolDetailOpenAnimation.cancel();
        } catch {}
        toolDetailOpenAnimation = null;
      }
      if (toolDetailCard) {
        toolDetailCard.style.willChange = "";
        toolDetailCard.style.transform = "";
        toolDetailCard.style.opacity = "";
        toolDetailCard.style.filter = "";
      }
      finalizeToolDetailClose();
    }

    function bindToolDetailModal() {
      toolDetailCloseButton.addEventListener("click", () => {
        closeToolDetailModal({ reverseToCard: true });
      });
      toolDetailOverlay.addEventListener("click", (event) => {
        if (event.target === toolDetailOverlay) {
          closeToolDetailModal();
        }
      });
    }

    function detectInitialLanguage() {
      try {
        const savedLanguage = localStorage.getItem("aicenghub.lang") || localStorage.getItem("aicenghub_lang");
        if (savedLanguage === "en" || savedLanguage === "id") return savedLanguage;
      } catch {}

      const browserLanguage = String(navigator.language || "en").toLowerCase();
      return browserLanguage.startsWith("id") ? "id" : "en";
    }

    function persistLanguage(lang) {
      if (consentState && consentState.personalization === false) return;
      try {
        localStorage.setItem("aicenghub.lang", lang);
        localStorage.setItem("aicenghub_lang", lang);
      } catch {}
    }

    function setCookie(name, value, days) {
      const maxAgeSeconds = Math.max(1, Math.floor(days * 24 * 60 * 60));
      document.cookie = `${encodeURIComponent(name)}=${encodeURIComponent(value)}; Max-Age=${maxAgeSeconds}; Path=/; SameSite=Lax`;
    }

    function sanitizeConsentState(value) {
      if (!value || typeof value !== "object") return null;
      const timestamp = String(value.timestamp || "").trim();
      const isTimestampValid = !Number.isNaN(Date.parse(timestamp));
      return {
        essential: true,
        analytics: Boolean(value.analytics),
        personalization: value.personalization !== false,
        timestamp: isTimestampValid ? timestamp : new Date().toISOString()
      };
    }

    function loadConsentState() {
      try {
        const raw = localStorage.getItem(CONSENT_STORAGE_KEY);
        if (!raw) return null;
        const parsed = JSON.parse(raw);
        return sanitizeConsentState(parsed);
      } catch {
        return null;
      }
    }

    function defaultConsentState() {
      return {
        essential: true,
        analytics: false,
        personalization: true,
        timestamp: new Date().toISOString()
      };
    }

    function clearPersonalizationStorage() {
      try {
        localStorage.removeItem("aicenghub.lang");
        localStorage.removeItem("aicenghub_lang");
        localStorage.removeItem(MUSIC_PREFERENCE_KEY);
      } catch {}
    }

    function saveConsentState(nextState) {
      const sanitized = sanitizeConsentState(nextState) || defaultConsentState();
      consentState = sanitized;
      try {
        localStorage.setItem(CONSENT_STORAGE_KEY, JSON.stringify(sanitized));
      } catch {}
      if (!sanitized.personalization) {
        clearPersonalizationStorage();
      }
      loadAnalyticsIfConsented(sanitized);
    }

    function loadMusicPreference() {
      if (consentState && consentState.personalization === false) {
        return true;
      }
      try {
        const stored = localStorage.getItem(MUSIC_PREFERENCE_KEY);
        if (stored === "0") return false;
        if (stored === "1") return true;
      } catch {}
      return true;
    }

    function saveMusicPreference(enabled) {
      if (consentState && consentState.personalization === false) return;
      try {
        localStorage.setItem(MUSIC_PREFERENCE_KEY, enabled ? "1" : "0");
      } catch {}
    }

    function getMusicToggleButtons() {
      return [musicToggleHero, musicTogglePopup].filter(Boolean);
    }

    function setMusicToggleLabel(button, text, pressed) {
      button.textContent = text;
      button.setAttribute("aria-pressed", pressed ? "true" : "false");
    }

    function updateMusicToggleState() {
      const buttons = getMusicToggleButtons();
      if (!musicEnabled) {
        buttons.forEach((button) => setMusicToggleLabel(button, "Sound Off", false));
        return;
      }
      if (!backgroundMusic.paused) {
        buttons.forEach((button) => setMusicToggleLabel(button, "Sound On", true));
        return;
      }
      buttons.forEach((button) => setMusicToggleLabel(button, "Play Sound", false));
    }

    function pickRandomMusicTrack() {
      if (!musicTracks.length) return "";
      if (musicTracks.length === 1) return musicTracks[0];
      const alternatives = musicTracks.filter((track) => track !== currentMusicTrack);
      const pool = alternatives.length ? alternatives : musicTracks;
      const index = Math.floor(Math.random() * pool.length);
      return pool[index];
    }

    function loadNextRandomTrack() {
      const nextTrack = pickRandomMusicTrack();
      if (!nextTrack) return "";
      currentMusicTrack = nextTrack;
      backgroundMusic.src = nextTrack;
      backgroundMusic.load();
      return nextTrack;
    }

    function stopBackgroundMusic() {
      backgroundMusic.pause();
      backgroundMusic.currentTime = 0;
    }

    async function tryStartBackgroundMusic() {
      if (!musicEnabled) return false;
      if (!backgroundMusic.src) {
        loadNextRandomTrack();
      }
      try {
        await backgroundMusic.play();
        return true;
      } catch {
        return false;
      }
    }

    async function setMusicEnabled(nextEnabled) {
      musicEnabled = Boolean(nextEnabled);
      saveMusicPreference(musicEnabled);

      if (!musicEnabled) {
        stopBackgroundMusic();
        updateMusicToggleState();
        return;
      }

      await tryStartBackgroundMusic();
      updateMusicToggleState();
    }

    function getCookie(name) {
      const target = `${encodeURIComponent(name)}=`;
      const parts = String(document.cookie || "").split(";");
      for (const part of parts) {
        const token = part.trim();
        if (token.startsWith(target)) {
          return decodeURIComponent(token.slice(target.length));
        }
      }
      return "";
    }

    function clearSiteCookiesOnly() {
      const cookieNames = String(document.cookie || "")
        .split(";")
        .map((token) => token.trim().split("=")[0].trim())
        .filter(Boolean);

      if (!cookieNames.length) return 0;

      const host = String(location.hostname || "").trim();
      const domainAttrs = [
        "",
        host ? `; Domain=${host}` : "",
        host && host.includes(".") ? `; Domain=.${host}` : ""
      ].filter((value, index, all) => all.indexOf(value) === index);

      for (const name of cookieNames) {
        for (const domainAttr of domainAttrs) {
          document.cookie = `${name}=; Max-Age=0; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Path=/${domainAttr}; SameSite=Lax`;
        }
      }

      return cookieNames.length;
    }

    function clearSiteLocalAppState() {
      const keysToRemove = [
        CONSENT_STORAGE_KEY,
        MUSIC_PREFERENCE_KEY,
        "aicenghub.lang",
        "aicenghub_lang",
        JULEHA_HISTORY_STORAGE_KEY
      ];

      let removedCount = 0;
      for (const key of keysToRemove) {
        try {
          if (localStorage.getItem(key) !== null) {
            localStorage.removeItem(key);
            removedCount += 1;
          }
        } catch {}
      }

      return removedCount;
    }

    function hideBunnyButton() {
      bunnyFab.hidden = true;
      bunnyFab.style.display = "none";
      bunnyFab.setAttribute("aria-hidden", "true");
    }

    function showBunnyButton() {
      bunnyFab.hidden = false;
      bunnyFab.style.display = "flex";
      bunnyFab.removeAttribute("aria-hidden");
    }

    function shouldShowBunnyOnLoad() {
      const hasSeenBefore = getCookie(BUNNY_SEEN_COOKIE_NAME) === "1";
      if (!hasSeenBefore) {
        setCookie(BUNNY_SEEN_COOKIE_NAME, "1", 3650);
        return true;
      }
      return Math.random() < BUNNY_RETURN_CHANCE;
    }

    function updateLanguageButtons() {
      const buttons = Array.from(langSwitch.querySelectorAll(".lang-btn"));
      buttons.forEach((button) => {
        const isActive = button.dataset.lang === currentLanguage;
        button.setAttribute("aria-pressed", isActive ? "true" : "false");
      });
    }

    function updateConsentLanguageToggle() {
      if (!consentLangToggle) return;
      const consent = getDictionary().consent;
      const nextLabel = currentLanguage === "id"
        ? consent.switchToEnglish
        : consent.switchToIndonesian;
      consentLangToggle.textContent = currentLanguage === "id" ? "ID" : "EN";
      consentLangToggle.setAttribute("aria-label", nextLabel);
      consentLangToggle.title = nextLabel;
    }

    function applyConsentTranslations() {
      const dictionary = getDictionary();
      const consent = dictionary.consent;
      consentTitle.textContent = consent.title;
      consentDescription.textContent = consent.description;
      consentAcceptButton.textContent = consent.agreeContinue;
      consentManageButton.textContent = consent.manageSettings;
      consentSaveButton.textContent = consent.savePreferences;
      consentLegalLink.textContent = consent.legalLink;
      consentEssentialLabel.textContent = consent.essentialLabel;
      consentEssentialDescription.textContent = consent.essentialDescription;
      consentAnalyticsLabel.textContent = consent.analyticsLabel;
      consentAnalyticsDescription.textContent = consent.analyticsDescription;
      consentPersonalizationLabel.textContent = consent.personalizationLabel;
      consentPersonalizationDescription.textContent = consent.personalizationDescription;
      consentSoundTip.textContent = consent.soundTip;
      updateConsentLanguageToggle();
    }

    function applyTranslations() {
      const dictionary = getDictionary();
      document.documentElement.lang = dictionary.htmlLang;
      heroDescription.textContent = dictionary.heroDescription;
      heroImage.alt = dictionary.heroImageAlt;
      globalSearchInput.placeholder = dictionary.searchPlaceholder;
      globalSearchBtn.textContent = dictionary.searchButton;
      panelTitle.textContent = dictionary.panelTitle;
      panelSubtitle.textContent = dictionary.panelSubtitle;
      footerTitle.textContent = dictionary.footerTitle;
      footerSubtitle.textContent = dictionary.footerSubtitle;
      footerCopyright.textContent = dictionary.footerCopyright;
      footerCredit.textContent = dictionary.footerCredit;
      privacySettingsTrigger.textContent = dictionary.privacySettingsLabel;
      legalLinkFooter.textContent = dictionary.legalLinkLabel;
      tablist.setAttribute("aria-label", dictionary.filterBarLabel);
      searchShell.setAttribute("aria-label", dictionary.searchBarLabel);
      langSwitch.setAttribute("aria-label", dictionary.languageSwitchLabel);
      applyConsentTranslations();
      applyToolDetailTranslations();
      if (activeToolDetail && !toolDetailOverlay.hidden) {
        populateToolDetailModal(activeToolDetail);
      }

      if (!tools.length) {
        searchStatus.textContent = dictionary.loadingTools;
      }

      updateLanguageButtons();
    }

    function setLanguage(lang) {
      if (!I18N[lang] || lang === currentLanguage) return;
      currentLanguage = lang;
      persistLanguage(lang);
      applyTranslations();
      buildFilterTabs();
      renderTools();
    }

    function bindLanguageSwitch() {
      const buttons = Array.from(langSwitch.querySelectorAll(".lang-btn"));
      buttons.forEach((button) => {
        button.addEventListener("click", () => setLanguage(button.dataset.lang));
      });
      if (consentLangToggle) {
        consentLangToggle.addEventListener("click", () => {
          setLanguage(currentLanguage === "id" ? "en" : "id");
        });
      }
    }

    function normalize(text) {
      return String(text || "").toLowerCase();
    }

    function tokenizeSearchQuery(query) {
      return normalize(query)
        .split(/\s+/)
        .map((token) => token.trim())
        .filter(Boolean);
    }

    function sanitizeUrl(rawUrl) {
      const candidate = String(rawUrl || "").trim();
      if (!candidate) return "#";

      try {
        const parsed = new URL(candidate);
        const allowedProtocols = new Set(["https:", "http:"]);
        if (!allowedProtocols.has(parsed.protocol)) return "#";
        if (!parsed.hostname) return "#";
        return parsed.href;
      } catch {
        return "#";
      }
    }

    function normalizeAbilities(rawTool) {
      const directAbilities = Array.isArray(rawTool.abilities)
        ? rawTool.abilities.map((ability) => normalize(ability)).filter(Boolean)
        : [];
      const normalizedDirectAbilities = [...new Set(directAbilities)].filter((ability) => ALLOWED_ABILITIES.has(ability));
      if (normalizedDirectAbilities.length) return normalizedDirectAbilities;

      const tags = normalizeToolTags(rawTool.tags);
      const inferredAbilities = [...new Set(tags.flatMap((tag) => TAG_TO_ABILITIES[tag] || []))]
        .filter((ability) => ALLOWED_ABILITIES.has(ability));
      return inferredAbilities;
    }

    function sanitizeTool(rawTool) {
      const abilities = normalizeAbilities(rawTool);
      const pricing = normalizePricingTier(rawTool && (rawTool.pricing || rawTool.pricingTier || rawTool.priceTier));
      const tags = normalizeToolTags(rawTool && rawTool.tags);

      return {
        name: String(rawTool.name || "Unknown Tool"),
        url: sanitizeUrl(rawTool.url),
        description: String(rawTool.description || ""),
        abilities,
        pricing,
        tags
      };
    }

    function createAbilityPill(ability) {
      const pill = document.createElement("span");
      pill.className = `ability-pill ability-${ability}`;
      const label = getAbilityLabel(ability);
      pill.setAttribute("aria-label", label);
      pill.title = label;
      return pill;
    }

    function createPricingPill(pricingTier) {
      const normalized = normalizePricingTier(pricingTier);
      const pill = document.createElement("span");
      pill.className = `pricing-pill pricing-pill-${normalized}`;
      const label = getPricingLabel(normalized);
      pill.setAttribute("aria-label", label);
      pill.title = label;
      return pill;
    }

    function createToolTag(tagKey) {
      const normalized = normalize(tagKey).replace(/\s+/g, "-");
      const chip = document.createElement("span");
      chip.className = `tool-tag tool-tag-${normalized}`;
      const label = getTagLabel(normalized);
      chip.textContent = label;
      chip.setAttribute("aria-label", label);
      return chip;
    }

    function createToolCard(tool) {
      const card = document.createElement("article");
      card.className = "card";
      card.tabIndex = 0;
      card.setAttribute("role", "button");
      card.setAttribute("aria-label", `${tool.name} details`);

      const openDetails = () => openToolDetailModal(tool, card);
      card.addEventListener("click", (event) => {
        const clicked = event.target;
        if (clicked instanceof Element && clicked.closest("a")) return;
        openDetails();
      });
      card.addEventListener("keydown", (event) => {
        const target = event.target;
        if (target instanceof Element && target.closest("a")) return;
        if (event.key === "Enter" || event.key === " ") {
          event.preventDefault();
          openDetails();
        }
      });

      const head = document.createElement("div");
      head.className = "card-head-row";

      const title = document.createElement("h3");
      title.textContent = tool.name;

      const abilityList = document.createElement("div");
      abilityList.className = "ability-list";
      tool.abilities.forEach((ability) => {
        abilityList.appendChild(createAbilityPill(ability));
      });

      head.append(title, abilityList);

      const description = document.createElement("p");
      description.textContent = tool.description;

      const tagList = document.createElement("div");
      tagList.className = "tool-tag-list";
      if (Array.isArray(tool.tags) && tool.tags.length) {
        tool.tags.forEach((tag) => {
          tagList.appendChild(createToolTag(tag));
        });
      }

      const pricingRow = document.createElement("div");
      pricingRow.className = "pricing-row";
      const pricingPill = createPricingPill(tool.pricing);
      const pricingText = document.createElement("span");
      pricingText.className = "pricing-text";
      pricingText.textContent = getPricingLabel(tool.pricing);
      pricingRow.append(pricingPill, pricingText);

      const link = document.createElement("a");
      link.href = tool.url;
      link.target = "_blank";
      link.rel = "noopener noreferrer";
      link.textContent = getDictionary().openLink;
      link.addEventListener("click", (event) => {
        event.stopPropagation();
      });

      card.append(head, description);
      if (tagList.childElementCount) {
        card.appendChild(tagList);
      }
      card.append(pricingRow, link);
      return card;
    }

    function matchesSearch(tool, query) {
      if (!query) return true;
      const normalizedQuery = normalize(query).trim();
      const tokens = tokenizeSearchQuery(normalizedQuery);
      if (!tokens.length) return true;

      const abilityAliasText = tool.abilities
        .flatMap((ability) => ABILITY_SEARCH_ALIASES[ability] || [ability])
        .join(" ");
      const tagAliasText = (Array.isArray(tool.tags) ? tool.tags : [])
        .flatMap((tag) => TAG_SEARCH_ALIASES[tag] || [tag])
        .join(" ");
      const pricingAliasText = PRICING_SEARCH_ALIASES[normalizePricingTier(tool.pricing)] || [];
      const haystack = normalize([
        tool.name,
        tool.url,
        tool.description,
        tool.abilities.join(" "),
        (Array.isArray(tool.tags) ? tool.tags.join(" ") : ""),
        tagAliasText,
        abilityAliasText,
        normalizePricingTier(tool.pricing),
        getPricingLabel(tool.pricing),
        pricingAliasText.join(" ")
      ].join(" "));

      if (haystack.includes(normalizedQuery)) return true;

      return tokens.some((token) => {
        if (haystack.includes(token)) return true;
        const mappedAbility = SEARCH_TOKEN_TO_ABILITY[token];
        if (mappedAbility && tool.abilities.includes(mappedAbility)) return true;
        const mappedTag = SEARCH_TOKEN_TO_TAG[token];
        if (mappedTag && Array.isArray(tool.tags) && tool.tags.includes(mappedTag)) return true;
        const mappedPricing = SEARCH_TOKEN_TO_PRICING[token];
        return mappedPricing ? normalizePricingTier(tool.pricing) === mappedPricing : false;
      });
    }

    function matchesFilter(tool, filterKey) {
      if (filterKey === "all") return true;
      return tool.abilities.includes(filterKey);
    }

    function getFilteredTools() {
      const effectiveQuery = searchQuery || (activeFilter !== "all" ? activeFilter : "");
      return tools
        .filter((tool) => matchesSearch(tool, effectiveQuery))
        .sort((a, b) => getPricingRank(a.pricing) - getPricingRank(b.pricing) || a.name.localeCompare(b.name));
    }

    function updateFilterButtonState() {
      const buttons = Array.from(tablist.querySelectorAll(".tab-btn"));
      buttons.forEach((button) => {
        const isActive = button.dataset.filterKey === activeFilter;
        button.setAttribute("aria-selected", isActive ? "true" : "false");
        button.tabIndex = isActive ? 0 : -1;
      });
    }

    function renderTools() {
      const results = getFilteredTools();
      toolGrid.innerHTML = "";

      const dictionary = getDictionary();
      const activeLabel = getAbilityLabel(activeFilter);
      const statusFilterLabel = searchQuery && activeFilter === "all"
        ? getAbilityLabel("all")
        : activeLabel;
      searchStatus.textContent = dictionary.status(results.length, tools.length, statusFilterLabel, searchQuery);

      if (!results.length) {
        const emptyCard = document.createElement("article");
        emptyCard.className = "card";
        const title = document.createElement("h3");
        title.textContent = dictionary.noMatchingTitle;
        const text = document.createElement("p");
        text.textContent = dictionary.noMatchingDescription;
        emptyCard.append(title, text);
        toolGrid.appendChild(emptyCard);
        return;
      }

      results.forEach((tool) => {
        toolGrid.appendChild(createToolCard(tool));
      });
    }

    function setActiveFilter(filterKey) {
      activeFilter = filterKey;
      searchQuery = filterKey === "all" ? "" : filterKey;
      globalSearchInput.value = searchQuery;
      updateFilterButtonState();
      renderTools();
    }

    function buildFilterTabs() {
      tablist.innerHTML = "";
      ABILITY_FILTER_KEYS.forEach((filterKey) => {
        const button = document.createElement("button");
        button.className = "tab-btn";
        button.type = "button";
        button.dataset.filterKey = filterKey;
        button.textContent = getAbilityLabel(filterKey);
        button.setAttribute("aria-selected", filterKey === activeFilter ? "true" : "false");
        button.tabIndex = filterKey === activeFilter ? 0 : -1;
        button.addEventListener("click", () => setActiveFilter(filterKey));
        tablist.appendChild(button);
      });

      const buttons = Array.from(tablist.querySelectorAll(".tab-btn"));
      buttons.forEach((button, index) => {
        button.addEventListener("keydown", (event) => {
          if (!["ArrowRight", "ArrowLeft", "Home", "End"].includes(event.key)) return;
          event.preventDefault();

          let nextIndex = index;
          if (event.key === "ArrowRight") nextIndex = (index + 1) % buttons.length;
          if (event.key === "ArrowLeft") nextIndex = (index - 1 + buttons.length) % buttons.length;
          if (event.key === "Home") nextIndex = 0;
          if (event.key === "End") nextIndex = buttons.length - 1;

          buttons[nextIndex].focus();
          setActiveFilter(buttons[nextIndex].dataset.filterKey);
        });
      });
    }

    function bindSearch() {
      function submitSearch() {
        if (searchDebounceTimer) {
          clearTimeout(searchDebounceTimer);
          searchDebounceTimer = null;
        }
        searchQuery = normalize(globalSearchInput.value.trim());
        activeFilter = searchQuery ? "all" : activeFilter;
        updateFilterButtonState();
        renderTools();
      }

      function queueSearch() {
        if (searchDebounceTimer) clearTimeout(searchDebounceTimer);
        searchDebounceTimer = setTimeout(() => {
          submitSearch();
        }, 500);
      }

      globalSearchBtn.addEventListener("click", submitSearch);
      globalSearchInput.addEventListener("input", queueSearch);
      globalSearchInput.addEventListener("keydown", (event) => {
        if (event.key !== "Enter") return;
        event.preventDefault();
        submitSearch();
      });
    }

    function resetSearchOnLoad() {
      activeFilter = "all";
      searchQuery = "";
      globalSearchInput.value = "";
    }

    function bindBunnyButton() {
      if (!shouldShowBunnyOnLoad()) {
        hideBunnyButton();
        return;
      }
      showBunnyButton();

      bunnyFab.addEventListener("click", () => {
        if (crazybunnyTimer) {
          clearTimeout(crazybunnyTimer);
          crazybunnyTimer = null;
        }
        crazybunnyOverlay.classList.add("is-active");
        try {
          crazybunnySound.currentTime = 0;
          const playPromise = crazybunnySound.play();
          if (playPromise && typeof playPromise.catch === "function") {
            playPromise.catch(() => {});
          }
        } catch {}
        setCookie(BUNNY_HIDDEN_COOKIE_NAME, "1", BUNNY_HIDE_DAYS);
        hideBunnyButton();
        crazybunnyTimer = setTimeout(() => {
          crazybunnyOverlay.classList.remove("is-active");
          crazybunnyTimer = null;
        }, 2000);
      }, { once: true });
    }

    function bindMusicToggle() {
      backgroundMusic.addEventListener("ended", async () => {
        if (!musicEnabled) return;
        loadNextRandomTrack();
        await tryStartBackgroundMusic();
        updateMusicToggleState();
      });

      updateMusicToggleState();
      if (consentState) {
        tryStartBackgroundMusic().finally(() => {
          updateMusicToggleState();
        });
      }

      const buttons = getMusicToggleButtons();
      buttons.forEach((button) => {
        button.addEventListener("click", async () => {
          if (!musicEnabled || backgroundMusic.paused) {
            await setMusicEnabled(true);
            return;
          }
          await setMusicEnabled(false);
        });
      });
    }

    function loadAnalyticsIfConsented(consent) {
      if (!consent || !consent.analytics) return;
      if (window.__aicenghubAnalyticsLoaded) return;
      window.__aicenghubAnalyticsLoaded = true;
      // Example conditional loader:
      // const script = document.createElement("script");
      // script.src = "https://analytics-provider.example/script.js";
      // script.defer = true;
      // document.head.appendChild(script);
      // Essential processing (Juleha chat and candidate-link capture) remains backend-required
      // and is intentionally not controlled by optional client consent toggles.
      console.info("AICENGHUB analytics placeholder loaded (consent.analytics=true).");
    }

    function syncConsentControls(state) {
      const source = state || defaultConsentState();
      consentEssentialToggle.checked = true;
      consentAnalyticsToggle.checked = Boolean(source.analytics);
      consentPersonalizationToggle.checked = source.personalization !== false;
    }

    function openConsentModal(showSettings) {
      const effectiveState = consentState || defaultConsentState();
      syncConsentControls(effectiveState);
      consentSettings.hidden = !showSettings;
      welcomePopup.hidden = false;
      document.body.classList.add("consent-open");
    }

    function closeConsentModal() {
      welcomePopup.hidden = true;
      consentSettings.hidden = true;
      document.body.classList.remove("consent-open");
    }

    async function applyConsentAndClose(nextState) {
      saveConsentState({
        essential: true,
        analytics: Boolean(nextState.analytics),
        personalization: nextState.personalization !== false,
        timestamp: new Date().toISOString()
      });
      if (consentState.personalization === false) {
        updateLanguageButtons();
      }
      closeConsentModal();
      if (musicEnabled && backgroundMusic.paused) {
        await tryStartBackgroundMusic();
        updateMusicToggleState();
      }
    }

    function bindWelcomePopup() {
      if (!consentState) {
        openConsentModal(false);
      } else {
        loadAnalyticsIfConsented(consentState);
      }

      consentManageButton.addEventListener("click", () => {
        consentSettings.hidden = !consentSettings.hidden;
      });

      consentAcceptButton.addEventListener("click", async () => {
        const defaults = defaultConsentState();
        await applyConsentAndClose(defaults);
      });

      consentSaveButton.addEventListener("click", async () => {
        await applyConsentAndClose({
          essential: true,
          analytics: consentAnalyticsToggle.checked,
          personalization: consentPersonalizationToggle.checked,
          timestamp: new Date().toISOString()
        });
      });

      privacySettingsTrigger.addEventListener("click", () => {
        openConsentModal(true);
      });
    }

    function bindVersionReset() {
      appVersion.addEventListener("click", () => {
        const confirmed = window.confirm("Clear this site's cookies and local app settings?");
        if (!confirmed) return;

        clearSiteCookiesOnly();
        clearSiteLocalAppState();
        // Reload to re-run first-load logic (agreement popup, bunny visibility, and related cookie-gated behavior).
        window.location.reload();
      });
    }

    function renderMessageLinks(container, text, verifiedLinksByUrl) {
      const pattern = /https?:\/\/[^\s<>"')\]]+/gi;
      const source = String(text || "");
      let lastIndex = 0;
      let match = pattern.exec(source);

      while (match) {
        const start = match.index;
        const rawUrl = match[0];
        const cleanedUrl = rawUrl.replace(/[.,!?;:]+$/g, "");
        const trailingPunctuation = rawUrl.slice(cleanedUrl.length);

        if (start > lastIndex) {
          container.appendChild(document.createTextNode(source.slice(lastIndex, start)));
        }

        const sanitized = sanitizeUrl(cleanedUrl);
        if (sanitized === "#") {
          container.appendChild(document.createTextNode(rawUrl));
        } else {
          const link = document.createElement("a");
          link.href = sanitized;
          link.target = "_blank";
          link.rel = "noopener noreferrer nofollow";
          link.textContent = cleanedUrl;
          container.appendChild(link);
          if (trailingPunctuation) {
            container.appendChild(document.createTextNode(trailingPunctuation));
          }

          const verification = verifiedLinksByUrl[sanitized];
          if (verification) {
            const suffix = verification.ok
              ? " (checked)"
              : ` (check failed${verification.status ? ` ${verification.status}` : ""})`;
            container.appendChild(document.createTextNode(suffix));
          }
        }

        lastIndex = pattern.lastIndex;
        match = pattern.exec(source);
      }

      if (lastIndex < source.length) {
        container.appendChild(document.createTextNode(source.slice(lastIndex)));
      }
    }

    function appendJulehaMessage(text, role, options = {}) {
      const message = document.createElement("p");
      message.className = `juleha-msg ${role}`;

      const verifiedLinks = Array.isArray(options.verifiedLinks) ? options.verifiedLinks : [];
      const verifiedLinksByUrl = verifiedLinks.reduce((accumulator, entry) => {
        if (!entry || !entry.url) return accumulator;
        const normalized = sanitizeUrl(entry.url);
        if (normalized !== "#") {
          accumulator[normalized] = entry;
        }
        return accumulator;
      }, {});

      renderMessageLinks(message, text, verifiedLinksByUrl);
      julehaChatLog.appendChild(message);
      julehaChatLog.scrollTop = julehaChatLog.scrollHeight;
    }

    function normalizeJulehaHistory(rawHistory) {
      if (!Array.isArray(rawHistory)) return [];
      const normalized = rawHistory
        .filter((entry) => entry && (entry.role === "user" || entry.role === "assistant"))
        .map((entry) => ({
          role: entry.role,
          content: String(entry.content || "").trim().slice(0, JULEHA_MAX_HISTORY_ITEM_CHARS)
        }))
        .filter((entry) => entry.content.length > 0);
      return normalized.slice(-JULEHA_MAX_HISTORY_MESSAGES);
    }

    function loadJulehaHistory() {
      try {
        const raw = localStorage.getItem(JULEHA_HISTORY_STORAGE_KEY);
        if (!raw) return [];
        const parsed = JSON.parse(raw);
        return normalizeJulehaHistory(parsed);
      } catch {
        return [];
      }
    }

    function saveJulehaHistory() {
      try {
        localStorage.setItem(JULEHA_HISTORY_STORAGE_KEY, JSON.stringify(julehaHistory));
      } catch {}
    }

    function compactPromptText(value, maxLength) {
      return String(value || "")
        .replace(/\s+/g, " ")
        .trim()
        .slice(0, maxLength);
    }

    function scoreToolForJuleha(tool, normalizedQuery, queryTokens) {
      if (!normalizedQuery) return 1;

      let score = 0;
      const nameText = normalize(tool.name);
      const descText = normalize(tool.description);
      const urlText = normalize(tool.url);
      const abilityText = normalize(tool.abilities.join(" "));
      const tagText = normalize((Array.isArray(tool.tags) ? tool.tags : []).join(" "));
      const pricingTier = normalizePricingTier(tool.pricing);
      const pricingText = normalize([pricingTier, getPricingLabel(pricingTier), ...(PRICING_SEARCH_ALIASES[pricingTier] || [])].join(" "));

      if (nameText.includes(normalizedQuery)) score += 8;
      if (descText.includes(normalizedQuery)) score += 5;
      if (abilityText.includes(normalizedQuery)) score += 4;
      if (tagText.includes(normalizedQuery)) score += 4;
      if (urlText.includes(normalizedQuery)) score += 2;
      if (pricingText.includes(normalizedQuery)) score += 3;

      queryTokens.forEach((token) => {
        if (!token) return;
        if (nameText.includes(token)) score += 3;
        if (descText.includes(token)) score += 2;
        if (urlText.includes(token)) score += 1;

        const mappedAbility = SEARCH_TOKEN_TO_ABILITY[token];
        if (mappedAbility && tool.abilities.includes(mappedAbility)) {
          score += 4;
        }

        const mappedPricing = SEARCH_TOKEN_TO_PRICING[token];
        if (mappedPricing && pricingTier === mappedPricing) {
          score += 4;
        }
        const mappedTag = SEARCH_TOKEN_TO_TAG[token];
        if (mappedTag && Array.isArray(tool.tags) && tool.tags.includes(mappedTag)) {
          score += 4;
        }
      });

      return score;
    }

    function buildJulehaCatalogContext(userText) {
      if (!tools.length) {
        return "AICENGHUB catalog is not loaded yet. If tool recommendations are requested, ask user to refresh.";
      }

      const normalizedQuery = normalize(userText).trim();
      const queryTokens = tokenizeSearchQuery(normalizedQuery);
      const ranked = tools
        .map((tool) => ({
          tool,
          score: scoreToolForJuleha(tool, normalizedQuery, queryTokens)
        }))
        .sort((a, b) =>
          getPricingRank(a.tool.pricing) - getPricingRank(b.tool.pricing)
          || b.score - a.score
          || a.tool.name.localeCompare(b.tool.name)
        );

      const picked = ranked
        .filter((entry) => normalizedQuery ? entry.score > 0 : true)
        .slice(0, JULEHA_MAX_CATALOG_ITEMS)
        .map((entry) => entry.tool);

      const finalPicked = picked.length
        ? picked
        : ranked.slice(0, JULEHA_MAX_CATALOG_ITEMS).map((entry) => entry.tool);

      const abilityCounts = ABILITY_FILTER_KEYS
        .filter((ability) => ability !== "all")
        .map((ability) => {
          const count = tools.filter((tool) => tool.abilities.includes(ability)).length;
          return `${ability}:${count}`;
        })
        .join(", ");
      const pricingCounts = ["free", "trial", "paid"]
        .map((tier) => `${tier}:${tools.filter((tool) => normalizePricingTier(tool.pricing) === tier).length}`)
        .join(", ");

      const catalogLines = finalPicked
        .map((tool) => {
          const name = compactPromptText(tool.name, 60);
          const url = compactPromptText(tool.url, 120);
          const description = compactPromptText(tool.description, 100);
          const abilities = tool.abilities.join(", ") || "none";
          const tags = (Array.isArray(tool.tags) && tool.tags.length) ? tool.tags.join(", ") : "none";
          const pricing = normalizePricingTier(tool.pricing);
          return `- ${name} | pricing: ${pricing} | tags: ${tags} | abilities: ${abilities} | url: ${url} | description: ${description}`;
        })
        .join("\n");

      return [
        "AICENGHUB catalog policy:",
        "- Prioritize tools listed below first.",
        "- Strict pricing priority for suggestions: free, then trial, then paid.",
        "- If user asks for tools outside this list, you may suggest external options from your own knowledge.",
        "- Clearly label external options as: external (not in AICENGHUB catalog).",
        "- Also provide closest listed alternatives when possible.",
        `Catalog totals: ${tools.length} tools.`,
        `Ability counts: ${abilityCounts}`,
        `Pricing counts: ${pricingCounts}`,
        "Relevant catalog entries:",
        catalogLines
      ].join("\n");
    }

    function buildJulehaRequestMessages(userText) {
      const catalogContext = buildJulehaCatalogContext(userText);
      return [
        { role: "system", content: JULEHA_SYSTEM_PROMPT },
        { role: "system", content: catalogContext },
        ...julehaHistory,
        { role: "user", content: userText }
      ];
    }

    function rememberJulehaExchange(userText, assistantText) {
      julehaHistory = normalizeJulehaHistory([
        ...julehaHistory,
        { role: "user", content: userText },
        { role: "assistant", content: assistantText }
      ]);
      saveJulehaHistory();
    }

    function startJulehaThinkingAnimation() {
      if (julehaThinkingDotsTimer) return;
      julehaChatSendButton.textContent = "Thinking";
      julehaThinkingDotsStep = 0;
      julehaThinkingDotsTimer = setInterval(() => {
        julehaThinkingDotsStep = (julehaThinkingDotsStep + 1) % 4;
        const dots = ".".repeat(julehaThinkingDotsStep);
        julehaChatSendButton.textContent = `Thinking${dots}`;
      }, 320);
    }

    function stopJulehaThinkingAnimation() {
      if (julehaThinkingDotsTimer) {
        clearInterval(julehaThinkingDotsTimer);
        julehaThinkingDotsTimer = null;
      }
      julehaThinkingDotsStep = 0;
      julehaChatSendButton.textContent = "Send";
    }

    function normalizeJulehaRouteLabel(label) {
      const raw = String(label || "").trim();
      if (!raw) return "unknown";

      if (raw.toLowerCase() === "policy-guardrail") {
        return "Safety Policy";
      }

      const cleaned = raw
        .replace(/\s*\((?:primary|secondary|tertiary|quaternary|backup|fallback)\)\s*/gi, " ")
        .replace(/\s*-\s*(?:primary|secondary|tertiary|quaternary|backup|fallback)\b/gi, "")
        .replace(/\s{2,}/g, " ")
        .trim();

      return cleaned || "unknown";
    }

    function setJulehaPendingState(isPending) {
      isJulehaRequestInFlight = isPending;
      julehaChatInput.disabled = isPending;
      julehaChatSendButton.disabled = isPending;
      if (isPending) {
        startJulehaThinkingAnimation();
      } else {
        stopJulehaThinkingAnimation();
      }
    }

    function setJulehaActiveRoute(label) {
      julehaActiveRouteLabel = normalizeJulehaRouteLabel(label || "loading...");
      julehaChatMeta.textContent = `Powered by: ${julehaActiveRouteLabel}`;
    }

    function extractAssistantText(rawContent) {
      if (typeof rawContent === "string") return rawContent.trim();
      if (!Array.isArray(rawContent)) return "";
      const textParts = rawContent
        .map((part) => {
          if (typeof part === "string") return part;
          if (part && typeof part.text === "string") return part.text;
          return "";
        })
        .filter(Boolean);
      return textParts.join("\n").trim();
    }

    async function requestJulehaReply(userText) {
      const messages = buildJulehaRequestMessages(userText);
      const response = await fetch(JULEHA_API_ENDPOINT, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ messages })
      });

      const payload = await response.json().catch(() => ({}));
      if (!response.ok) {
        const errorMessage = payload && payload.error
          ? String(payload.error)
          : `HTTP ${response.status}`;
        throw new Error(errorMessage);
      }

      const assistantText = extractAssistantText(payload.assistantText);
      if (!assistantText) {
        throw new Error("Juleha API returned an empty response.");
      }

      const routeLabel = payload && payload.routeLabel ? String(payload.routeLabel) : "server route";
      rememberJulehaExchange(userText, assistantText);
      return {
        assistantText,
        routeLabel,
        verifiedLinks: Array.isArray(payload.verifiedLinks) ? payload.verifiedLinks : []
      };
    }

    function openJulehaChat() {
      julehaChatWindow.hidden = false;
      julehaFab.setAttribute("aria-expanded", "true");
      julehaChatInput.focus();
    }

    function closeJulehaChat() {
      julehaChatWindow.hidden = true;
      julehaFab.setAttribute("aria-expanded", "false");
      julehaFab.focus();
    }

    function bindJulehaChat() {
      setJulehaActiveRoute(julehaActiveRouteLabel);
      if (julehaHistory.length) {
        appendJulehaMessage(`Memory restored (${Math.floor(julehaHistory.length / 2)} turns).`, "assistant");
        julehaHistory.forEach((entry) => {
          appendJulehaMessage(entry.content, entry.role);
        });
      } else {
        appendJulehaMessage("Selamat datang di AICENGHUB! Juleha disini siap membantu! AI apa yang Anda cari?", "assistant");
      }

      julehaFab.addEventListener("click", () => {
        if (julehaChatWindow.hidden) {
          openJulehaChat();
          return;
        }
        closeJulehaChat();
      });

      julehaChatClose.addEventListener("click", () => {
        closeJulehaChat();
      });

      julehaChatForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        if (isJulehaRequestInFlight) return;
        const text = julehaChatInput.value.trim();
        if (!text) return;

        appendJulehaMessage(text, "user");
        julehaChatInput.value = "";

        try {
          setJulehaPendingState(true);
          const result = await requestJulehaReply(text);
          setJulehaActiveRoute(result.routeLabel);
          appendJulehaMessage(result.assistantText, "assistant", { verifiedLinks: result.verifiedLinks });
        } catch (error) {
          const message = error instanceof Error ? error.message : "Failed to reach Juleha service.";
          setJulehaActiveRoute("unavailable");
          appendJulehaMessage(`Juleha error: ${message}`, "assistant");
        } finally {
          setJulehaPendingState(false);
          julehaChatInput.focus();
        }
      });

      document.addEventListener("keydown", (event) => {
        if (event.key === "Escape" && !toolDetailOverlay.hidden) {
          closeToolDetailModal();
          return;
        }
        if (event.key === "Escape" && !julehaChatWindow.hidden) {
          closeJulehaChat();
        }
      });
    }

    function primeCrazyBunnyAssets() {
      crazybunnyPreloadedImage = new Image();
      crazybunnyPreloadedImage.src = crazybunnyImage.src;
      try {
        crazybunnySound.load();
      } catch {}
    }

    async function loadTools() {
      try {
        const response = await fetch("/api/link-list", { cache: "no-store" });
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        const data = await response.json();
        if (!Array.isArray(data)) throw new Error("Invalid JSON shape");
        tools = data.map(sanitizeTool);
        renderTools();
      } catch (error) {
        searchStatus.textContent = getDictionary().loadError;
        console.error("Failed to load tool data:", error);
      }
    }

    applyTranslations();
    primeCrazyBunnyAssets();
    buildFilterTabs();
    resetSearchOnLoad();
    window.addEventListener("pageshow", resetSearchOnLoad);
    bindSearch();
    bindLanguageSwitch();
    bindBunnyButton();
    bindMusicToggle();
    bindWelcomePopup();
    bindToolDetailModal();
    bindVersionReset();
    bindJulehaChat();
    loadTools();
  </script>
</body>
</html>

































